gsom=(function(){var E={};gsomMYSQLReservedWords=["ADD","ALL","ALTER","ANALYZE","AND","AS","ASC","ASENSITIVE","BEFORE","BETWEEN","BIGINT","BINARY","BLOB","BOTH","BY","CALL","CASCADE","CASE","CHANGE","CHAR","CHARACTER","CHECK","COLLATE","COLUMN","CONDITION","CONSTRAINT","CONTINUE","CONVERT","CREATE","CROSS","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATABASES","DAY_HOUR","DAY_MICROSECOND","DAY_MINUTE","DAY_SECOND","DEC","DECIMAL","DECLARE","DEFAULT","DELAYED","DELETE","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DOUBLE","DROP","DUAL","EACH","ELSE","ELSEIF","ENCLOSED","ESCAPED","EXISTS","EXIT","EXPLAIN","FALSE","FETCH","FLOAT","FLOAT4","FLOAT8","FOR","FORCE","FOREIGN","FROM","FULLTEXT","GRANT","GROUP","HAVING","HIGH_PRIORITY","HOUR_MICROSECOND","HOUR_MINUTE","HOUR_SECOND","IF","IGNORE","IN","INDEX","INFILE","INNER","INOUT","INSENSITIVE","INSERT","INT","INT1","INT2","INT3","INT4","INT8","INTEGER","INTERVAL","INTO","IS","ITERATE","JOIN","KEY","KEYS","KILL","LEADING","LEAVE","LEFT","LIKE","LIMIT","LINES","LOAD","LOCALTIME","LOCALTIMESTAMP","LOCK","LONG","LONGBLOB","LONGTEXT","LOOP","LOW_PRIORITY","MATCH","MEDIUMBLOB","MEDIUMINT","MEDIUMTEXT","MIDDLEINT","MINUTE_MICROSECOND","MINUTE_SECOND","MOD","MODIFIES","NATURAL","NOT","NO_WRITE_TO_BINLOG","NULL","NUMERIC","ON","OPTIMIZE","OPTION","OPTIONALLY","OR","ORDER","OUT","OUTER","OUTFILE","PRECISION","PRIMARY","PROCEDURE","PURGE","READ","READS","REAL","REFERENCES","REGEXP","RELEASE","RENAME","REPEAT","REPLACE","REQUIRE","RESTRICT","RETURN","REVOKE","RIGHT","RLIKE","SCHEMA","SCHEMAS","SECOND_MICROSECOND","SELECT","SENSITIVE","SEPARATOR","SET","SHOW","SMALLINT","SONAME","SPATIAL","SPECIFIC","SQL","SQLEXCEPTION","SQLSTATE","SQLWARNING","SQL_BIG_RESULT","SQL_CALC_FOUND_ROWS","SQL_SMALL_RESULT","SSL","STARTING","STRAIGHT_JOIN","TABLE","TERMINATED","THEN","TINYBLOB","TINYINT","TINYTEXT","TO","TRAILING","TRIGGER","TRUE","UNDO","UNION","UNIQUE","UNLOCK","UNSIGNED","UPDATE","USAGE","USE","USING","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","VALUES","VARBINARY","VARCHAR","VARCHARACTER","VARYING","WHEN","WHERE","WHILE","WITH","WRITE","XOR","YEAR_MONTH","ZEROFILL","ASENSITIVE","CALL","CONDITION","CONNECTION","CONTINUE","CURSOR","DECLARE","DETERMINISTIC","EACH","ELSEIF","EXIT","FETCH","GOTO","INOUT","INSENSITIVE","ITERATE","LABEL","LEAVE","LOOP","MODIFIES","OUT","READS","RELEASE","REPEAT","RETURN","SCHEMA","SCHEMAS","SENSITIVE","SPECIFIC","SQL","SQLEXCEPTION","SQLSTATE","SQLWARNING","TRIGGER","UNDO","UPGRADE","WHILE"];gsomAppState={page:1,ipp:25,show:"all",q:""};function v(N){return N.replace(/[\s]+/g,"_").replace(/[^A-Za-z0-9\_]+/g,"").substring(0,20)}function t(N){return N.match(/\b([_a-z0-9-]+(\.[_a-z0-9-]+)*)@([_a-z0-9-]+(\.[_a-z0-9-]+)*)(\.([a-z]{2,10}))\b/gi)}function F(R){R=R||{};var O=R.arr||[],Q=R.place||"gsom-fields-list",N=R.makeDivs||false,P=N?"div":"li";if(glock.isDef(O)){for(var S=0;S<O.length;S++){C({ul:Q,label:O[S].label,type:O[S].type,value:O[S].value,name:O[S].name,checked:O[S].checked,itemType:P})}b()}var T=glock.x(Q);if(T.nodeName.toLowerCase()!="form"){T=T.up("form")}}function C(R){R=R||{};var ab=R.ul||"",an=R.oldItem||false,U=R.type||"text",Y=R.label||"",ao=R.name||"",T=R.value||"",X=R.checked||false,ap=R.itemType||"li",al=glock.x(ab),ae="",Q,O;if(an){O=glock.x(an);if(O){Q=O.down("span.gsom-oldname");if(Q){ae=Q.innerHTML}else{Q=O.down("input");if(Q){ae=Q.name}}}}var Z=function(at){at=at.toUpperCase();for(var ar=0;ar<gsomMYSQLReservedWords.length;ar++){if(gsomMYSQLReservedWords[ar]==at){return true}}return false};var N=function(au){if(al){var at=glock.x(al).select("input");for(var ar=0;ar<at.length;ar++){if(at[ar].name==au){return true}}}return false};fn=(ao=="")?Y:ao;if(!an){var ak=0;do{ao=v(fn);if(ak>0){ao+=String(ak)}ak++}while(N(ao)||Z(ao))}else{ao=ae}var af,V,aj,S;var am=new Date(),ai="sfi_"+am.getTime(),ah="",aa="";var P=window.gsomAdminMenu||false;if(P){aa="gsom-optin-radiogroup-admin"}else{aa="gsom-optin-radiogroup"}if((U=="text")&&(ap=="div")){ah="gsom-optin-div-label"}else{ah="gsom-optin-label"}function ad(ar){el=this;sfi=glock.x(el).up("div.gsom_sfi");if(sfi){m=sfi.down(".gsom-required-msg");if(m){m.hide()}}}switch(U){case"text":var W;af=glock.builder.node(ap,{id:ai,className:"gsom_sfi"});if(P){W=glock.builder.node("div",{className:"gsom-list-item-wrapper"});af.appendChild(W);if(ao!="gsom_email_field"){af.appendChild(glock.builder.node("div",{style:"float:left; overflow: hidden;"},[n({imgsrc:gsomPluginPath+"img/delete.png",onclick:glock.xF(p).bindAsEventListener(af)}),n({imgsrc:gsomPluginPath+"img/pencil.png",onclick:glock.xF(function(){var ar=glock.x(this).id;z({oldItem:ar})}).bindAsEventListener(af)})]))}else{af.appendChild(glock.builder.node("div",{style:"float:left; overflow: hidden;"},[n({imgsrc:gsomPluginPath+"img/pencil.png",onclick:glock.xF(function(){var ar=glock.x(this).id;L({fieldId:ar})}).bindAsEventListener(af)})]))}}else{W=af}W.appendChild(glock.builder.node("label",{className:ah},Y));W.appendChild(S=glock.builder.node("input",{type:"text",name:ao,value:T}));glock.event.observe(S,"click",glock.xF(ad).bindAsEventListener(S));W.appendChild(glock.builder.node("span",{className:"gsom-required-msg",style:"display:none;"},"Required"));if(ao=="gsom_email_field"){W.appendChild(glock.builder.node("span",{className:"gsom-required-msg gsom-bademail-msg",style:"display:none;"},"Bad Email Address"))}break;case"checkbox":var aq;var W;if(X){aq={type:"checkbox",checked:"checked",name:ao,value:"1"}}else{aq={type:"checkbox",name:ao,value:"1"}}af=glock.builder.node(ap,{id:ai,className:"gsom_sfi"});if(P){W=glock.builder.node("div",{className:"gsom-list-item-wrapper"});af.appendChild(W);af.appendChild(glock.builder.node("div",{style:"float:left"},[n({imgsrc:gsomPluginPath+"img/delete.png",onclick:glock.xF(p).bindAsEventListener(af)}),n({imgsrc:gsomPluginPath+"img/pencil.png",onclick:glock.xF(function(){var ar=glock.x(this).id;I({oldItem:ar})}).bindAsEventListener(af)})]))}else{W=af}W.appendChild(glock.builder.node("div",{className:aa},[S=glock.builder.node("input",aq),glock.builder.node("label",{className:ah},Y)]));glock.event.observe(S,"click",glock.xF(ad).bindAsEventListener(S));W.appendChild(glock.builder.node("span",{style:"display:none",className:"gsom-required-msg cbox"},"Required"));break;case"radio":var W;af=glock.builder.node(ap,{id:ai,className:"gsom_sfi"});if(P){W=glock.builder.node("div",{className:"gsom-list-item-wrapper"});af.appendChild(W);af.appendChild(glock.builder.node("div",{style:"float:left"},[n({imgsrc:gsomPluginPath+"img/delete.png",onclick:glock.xF(p).bindAsEventListener(af)}),n({imgsrc:gsomPluginPath+"img/pencil.png",onclick:glock.xF(function(){var ar=glock.x(this).id;l({oldItem:ar})}).bindAsEventListener(af)})]))}else{W=af}W.appendChild(glock.builder.node("label",{className:"gsom-optin-label radio"},Y));W.appendChild(glock.builder.node("span",{style:"display:none;",className:"gsom-required-msg radio"},"Required"));for(var ag=0;ag<T.length;ag++){aj=glock.builder.node("div",{className:aa});W.appendChild(aj);V=glock.builder.node("input",{type:"radio",name:ao,value:v(T[ag].label)});if(T[ag].checked){V.checked=true}aj.appendChild(V);glock.event.observe(V,"change",glock.xF(ad).bindAsEventListener(V));V=glock.builder.node("label",{className:ah},T[ag].label);aj.appendChild(V)}break;case"button":case"submit":ao="gsomsubscribe";af=glock.builder.node(ap,{id:ai});W=glock.builder.node("div",{className:"gsom-list-item-wrapper"});af.appendChild(W);af.appendChild(glock.builder.node("div",{style:"float:left"},[n({imgsrc:gsomPluginPath+"img/pencil.png",onclick:glock.xF(function(){var ar=glock.x(this).id;q({oldItem:ar})}).bindAsEventListener(af)})]));W.appendChild(glock.builder.node("div",{className:aa},[glock.builder.node("input",{type:"button",name:ao,value:T})]));break}if(ae){W.appendChild(glock.builder.node("span",{className:"gsom-oldname"},ae))}glock.event.observe(af,"mouseup",function(){var ar=ar||glock.emptyFunction;ar()});if(al){if(an){var ac=glock.x(an);if(ac){al.insertBefore(af,ac)}glock.element.remove(ac)}else{al.appendChild(af)}return true}return false}function c(N){mdOption=glock.x("gsom-mdo-smtp");if(mdOption){var O=glock.x("gsom-smtp-settings");if(O){if(N){O.show()}else{O.hide()}}glock.x("gsom-test-email-status").innerHTML=""}}function x(){mdOption=glock.x("gsom-mdo-smtp");if(mdOption){if(mdOption.checked){glock.x("gsom-smtp-settings").show()}}btn=H({caption:"Default",onclick:function(){if(confirm("Are you sure you want to reset all fields to defaults?")){f(glock.x("gsom-fields-list"));F({arr:gsomdef_form})}},width:glock.env.ie?82:64});if(btn){glock.x("gsom-ddbutton-restore").appendChild(btn)}btn=new A({caption:"Add Field",id:"gsom-dropdown-add-field",items:[{caption:"Text Field",onclick:function(){z()}},{caption:"Checkbox",onclick:function(){I()}},{caption:"Radio Group",onclick:function(){l()}}],width:glock.env.ie?82:64});if(btn.ibtn){glock.x("gsom-ddbutton-placeholder").appendChild(btn.ibtn)}btn=H({caption:"Test",onclick:function(){var X=glock.x("gsom_smtp_test_email").value,R=glock.x("gsom_smtp_hostname").value,W=glock.x("gsom_smtp_username").value,Q=glock.x("gsom_smtp_password").value,U=glock.x("gsom_smtp_port").value,V="off",Y,P="sendmail";if(glock.x("gsom-mdo-sendmail").checked){P="sendmail"}else{if(glock.x("gsom-mdo-smtp").checked){P="smtp"}else{if(glock.x("gsom-mdo-phpmail").checked){P="phpmail"}}}Y=glock.x("gsom_smtp_secure_conn").select("input");glock.a.each(Y,function(Z){if(Z.checked){V=Z.value}});var S={host:R,username:W,password:Q,port:U,testemail:X,auth:V,mdo:P};var T=glock.x("gsom-test-email-status");if(T){f(T);T.appendChild(glock.builder.node("div",{style:"overflow:hidden;"},[glock.builder.node("img",{style:"margin-top:3px; float:left;",src:"images/loading.gif"}),glock.builder.node("span",{style:"float:left; margin-left: 5px;"},"Sending test email...")]))}document.body.style.cursor="wait";S.action="gsom_test_smtp";glock.ajax.makeRequest(ajaxurl,{method:"post",parameters:S,requestHeaders:{Accept:"application/json"},onComplete:function(Z){document.body.style.cursor="default"},onSuccess:function(aa){var Z=glock.json.parse(aa.responseText);f(T);if(T){f(T)}if(Z.state=="true"){if(T){T.appendChild(glock.builder.node("span",{style:"color:green;"},"Your SMTP account data is correct."))}}else{if(T){T.appendChild(glock.builder.node("span",{style:"color:red;"},Z.msg))}}}})},width:50});glock.x("smtp-btn-test-ph").appendChild(btn);var O=glock.x("gsom-load-gmail-preset");if(O){glock.event.observe(O,"click",function(){glock.x("gsom_smtp_hostname").value="smtp.gmail.com";glock.x("gsom_smtp_port").value="465";glock.x("gsom_smtp_secure_conn_ssl").checked=true;glock.x("gsom_smtp_username").value="your_address@gmail.com";glock.x("gsom_smtp_password").value="";glock.x("gsom_smtp_username").focus()})}glock.event.observe(document.body,"click",glock.xF(function(Q){var P=glock.event.element(Q);var R=glock.x(P).up("ul.glbuttonddlist");if(R){return}R=glock.x(P).up("div#gsom-dropdown-add-field");if(R){return}if(this.lst){if(glock.x(this.lst).visible()){this.lst.hide()}}}).bindAsEventListener(btn));var N=glock.x("gsom-tabs").select("span");glock.xA(N).each(glock.xF(function(Q){var P=this;glock.event.observe(Q,"click",glock.xF(function(){var S=this;glock.xA(S).each(function(T){glock.x(T.parentNode).removeClassName("gsom-tabs-selected");glock.x(T.id.replace(/gsom-tab-/g,"gsom-page-")).hide()});glock.x(Q.parentNode).addClassName("gsom-tabs-selected");if(glock.env.opera){Q.parentNode.parentNode.style.visibility="hidden";setTimeout(function(){Q.parentNode.parentNode.style.visibility=""},1)}var R=Q.id.replace(/gsom-tab-/g,"gsom-page-");glock.x("gsom_tab_inp").value=R;glock.x(R).show()}).bind(P))}).bind(N))}function y(O){var P=glock.x("gsom-tabs").select("span");var N=O;var O=O.replace(/gsom-page-/g,"gsom-tab-");var Q=glock.x(O);glock.a.each(P,function(R){glock.x(R.parentNode).removeClassName("gsom-tabs-selected");glock.x(R.id.replace(/gsom-tab-/g,"gsom-page-")).hide()});glock.x(Q.parentNode).addClassName("gsom-tabs-selected");glock.x(N).show()}function G(T){var T=T||{},O=T.date||false,U=T.query||"",Q={},W=T.day,R=T.mysqldate||"",S=T.monthnum,V=T.year,P=T.limit||30,N=glock.x("gsom-bcst-posts");Q.query=U;Q.limit=P;Q.mysqldate=R;Q.action="gsom_aj_get_posts";f(N);N.appendChild(glock.builder.node("div",{style:"overflow:hidden; width: 70px; margin: 0 auto; position:relative; top:40%;"},[glock.builder.node("img",{style:"float:left;",src:"images/loading.gif"}),glock.builder.node("span",{style:"float:left; margin-left: 5px;"},"Loading")]));glock.ajax.makeRequest(ajaxurl,{method:"post",parameters:Q,requestHeaders:{Accept:"application/json"},onSuccess:function(ae){var ab=glock.json.parse(ae.responseText);var Y=glock.xF(glock.builder.node).bind(glock.builder),aa,ac,ad,Z,X;f(N);if(ab.state=="true"){if(ab.posts.length){for(aa=0;aa<ab.posts.length;aa++){ac=Y("div",{className:"gsom-bcst-post"},[Y("div",{className:"gsom-bcst-post-hdr"},[ad=Y("span",{className:"gsom-date"}),Z=Y("span",{className:"gsom-title"})]),X=Y("span")]);ad.innerHTML=ab.posts[aa].date;Z.innerHTML=ab.posts[aa].title;X.innerHTML=ab.posts[aa].description;N.appendChild(ac)}}else{N.appendChild(Y("div",{style:"margin: 0 auto; position:relative; top:40%; width:220px;"},"Sorry, no posts matched your criteria."))}}else{N.appendChild(Y("div",ab.msg))}}})}function a(ah,Z,X,Y,aj){var N=[],ad=[],ab=[],Q="",S="",O="",ae;for(var ai=1;ai<=31;ai++){N[N.length]=ai}function R(){if(this.value=="dom"){glock.x("gsom_bcst_day_number").show()}else{glock.x("gsom_bcst_day_number").hide()}}function aa(){var aq=glock.x("gsom_excerpt_block"),ar=glock.x("gsom_show_full_posts");if(ar){if(!ar.checked){aq.show()}else{aq.hide()}}}aa();function ao(aq){var at="",au=true,ar=0;glock.xA(aq).each(function(av){if(av.checked){if(au){au=false;delim=""}else{delim=", "}at+=delim+av.value;ar++}});if(ar==aq.length){at=""}return at}catDDList=glock.ui.makeCbDropdownList({items:aj,place:"gsom-bcst-sel-cat",width:200,onChange:W});authDDList=glock.ui.makeCbDropdownList({items:gsom_auths,width:200,place:"gsom-bcst-sel-auth",onChange:W});ae=glock.ui.makeDDCalendar({cal:{date:gsom_last_bcst,showTime:true},format:"MMMM dd, yyyy hh:mm tt",place:"gsom-bc-start-cal",onChange:W});function W(){var at,ar="",aq=glock.x("gsom_feed_limit").value||10;ar="showposts="+aq;at=catDDList.getCSValues();if(at!=""){ar+="&cat="+at}at=authDDList.getCSValues();if(at!=""){ar+="&author="+at}G({query:ar,day:ae.now.getDate(),monthnum:(ae.now.getMonth()+1),year:ae.now.getFullYear(),mysqldate:ae.getMYSQLDate(),limit:aq})}ah=ah||false;Z=Z||false;X=X||false;Y=Y||false;M("gsom_bcst_day_number",N,Y);M("gsom_bcst_when",[{text:"Monday",value:"mon"},{text:"Tuesday",value:"tue"},{text:"Wednesday",value:"wed"},{text:"Thursday",value:"thu"},{text:"Friday",value:"fri"},{text:"Saturday",value:"sat"},{text:"Sunday",value:"sun"},{text:"Day of month",value:"dom"}],ah);M("gsom_bcst_dom_post_limit",["1","2","3","4","5","6","7","8","9","10"],Z);M("gsom_bcst_number_of_posts",["1","2","3","4","5","6","7","8","9","10"],X);gsomBcstWhen=glock.x("gsom_bcst_when");if(gsomBcstWhen){(glock.xF(R).bind(gsomBcstWhen))();glock.event.observe(gsomBcstWhen,"click",glock.xF(R).bindAsEventListener(gsomBcstWhen))}var ak=glock.x("gsom_show_full_posts");if(ak){glock.event.observe(ak,"click",glock.xF(aa).bindAsEventListener(ak))}W();var V=glock.x("gsom_bcst_test_btn");if(V){glock.event.observe(V,"click",function(){var at=glock.x("gsom_bcst_test_email").value;var ar={testemail:at};var aq=glock.x("bcst_test_status");if(aq){f(aq);aq.appendChild(glock.builder.node("div",{style:"margin-top:6px; overflow:hidden;"},[glock.builder.node("img",{style:"margin-top:3px; float:left;",src:"images/loading.gif"}),glock.builder.node("span",{style:"float:left; margin-left: 5px;"},"Sending test email...")]))}if(glock.xS(at).trim()===""){if(aq){f(aq);aq.appendChild(glock.builder.node("span",{style:"float:left; margin-top:6px;color:red;"},"Please specify an email address."))}return}ar.action="gsom_test_broadcast";glock.ajax.makeRequest(ajaxurl,{method:"post",parameters:ar,requestHeaders:{Accept:"application/json"},onComplete:function(au){document.body.style.cursor="default"},onSuccess:function(av){var au=glock.json.parse(av.responseText);if(aq){f(aq)}if(au.state=="true"){if(aq){aq.appendChild(glock.builder.node("span",{style:"color:green;"},au.msg))}}else{if(aq){aq.appendChild(glock.builder.node("span",{style:"color:red;"},au.msg))}}}})})}var al=glock.x("gsom_bcst_loadtemplates_btn");if(al){glock.event.observe(al,"click",function(){if(!confirm("Are you sure you want to load default template?")){return}var aq={o:"gsom_def_bcst_email_subj, gsom_def_bcst_email_msg, gsom_def_bcst_email_msg_plain",action:"gsom_aj_get_options"};glock.ajax.makeRequest(ajaxurl,{method:"post",parameters:aq,requestHeaders:{Accept:"application/json"},onSuccess:function(au){var at=glock.json.parse(au.responseText),ar;ar=at.options.gsom_def_bcst_email_subj;if(ar){glock.x("gsom_bcst_email_subj").value=ar}ar=at.options.gsom_def_bcst_email_msg_plain;if(ar){glock.x("gsom_bcst_email_msg_plain").value=ar}glock.x("gsom_bcst_email_msg").value=at.options.gsom_def_bcst_email_msg}})})}function af(){glock.ajax.makeRequest(ajaxurl,{method:"post",parameters:{action:"gsom_aj_get_broadcast_status"},requestHeaders:{Accept:"application/json"},onSuccess:function(at){var ar=glock.json.parse(at.responseText),aq=glock.x("bcst_status");if(aq){if(ar.state=="true"){aq.removeClassName("bcst_status_idle");aq.removeClassName("bcst_status_running");aq.removeClassName("bcst_status_error");if(ar.msg=="broadcasting"){aq.addClassName("bcst_status_running");aq.innerHTML="broadcasting";setTimeout(af,5000)}else{if(ar.msg=="done"){aq.addClassName("bcst_status_idle");aq.innerHTML="stand by";glock.x("gsom_run_broadcast_now").disabled=false;ae.setDate()}else{aq.addClassName("bcst_status_error");aq.innerHTML=ar.msg}}}else{aq.removeClassName("bcst_status_idle");aq.removeClassName("bcst_status_running");aq.addClassName("bcst_status_error");aq.innerHTML=ar.msg}}}})}var U=glock.x("gsom_run_broadcast_now");if(U){U.writeAttribute("type","button");glock.event.observe(U,"click",function(){if(E.optionsChanged){if(confirm("Your new options are not saved. Do you want to save options and run broadcast?")){P(true)}else{return}}else{if(!confirm("Are you sure you want to start broadcast?")){return}}glock.ajax.makeRequest(ajaxurl,{method:"post",parameters:{action:"gsom_aj_run_broadcast"},requestHeaders:{Accept:"application/json"},onSuccess:function(at){var ar=glock.json.parse(at.responseText),aq=glock.x("bcst_status");if(aq){if(ar.state=="false"){aq.removeClassName("bcst_status_idle");aq.removeClassName("bcst_status_running");aq.addClassName("bcst_status_error");aq.innerHTML=ar.msg}else{glock.ajax.makeRequest(ar.bu,{method:"GET"});aq.removeClassName("bcst_status_idle");aq.addClassName("bcst_status_running");aq.innerHTML="broadcasting";glock.x("gsom_run_broadcast_now").disabled=true;setTimeout(af,5000)}}}})})}var ag=function(){E.optionsChanged=true};var ap=glock.x("gsom_form"),an=[];if(ap){an=an.concat(ap.select("input"),ap.select("textarea"),ap.select("select"));glock.xA(an).each(function(ar){if((ar.type=="submit")||(ar.type=="button")){return}if((ar.name=="gsom_bcst_email_msg")&&(typeof tinyMCE!="undefined")){var aq=tinyMCE.getInstanceById("gsom_bcst_email_msg");if(aq){aq.onChange=ag}}else{if(ar.glockEl){ar.glockEl._onChange=ar.glockEl.onChange;ar.glockEl.onChange=function(){if(ar.glockEl._onChange){ar.glockEl._onChange()}ag()}}else{if(ar.name=="gsom_feed_limit"){glock.event.observe(ar,"change",function(){ag();W()})}else{glock.event.observe(ar,"change",ag)}}}})}function P(at){var aq=glock.x("gsom_form"),ar=[],at=at||false,au={};if(aq){ar=ar.concat(aq.select("input"),aq.select("textarea"),aq.select("select"));glock.xA(ar).each(function(aw){if((aw.type=="submit")||(aw.type=="button")){return}if(aw.type=="checkbox"){au[aw.name]=aw.checked?"1":"0"}else{if(aw.type=="radio"){if(aw.checked){au[aw.name]=aw.value}else{if(!au[aw.name]){au[aw.name]=""}}}else{if((aw.name=="gsom_bcst_email_msg")&&(typeof tinyMCE!="undefined")){var av=tinyMCE.getInstanceById("gsom_bcst_email_msg");if(av){au[aw.name]=av.getContent()}else{au[aw.name]=aw.value}}else{au[aw.name]=aw.value}}}})}au.action="gsom_aj_update_broadcast_settings";glock.ajax.makeRequest(ajaxurl,{method:"post",parameters:au,asynchronous:!at,requestHeaders:{Accept:"application/json"},onSuccess:function(ax){var aw=glock.json.parse(ax.responseText);if(aw.state=="true"){E.optionsChanged=false;glock.x("gsom_updo_notification").show();setTimeout(function(){glock.x("gsom_updo_notification").hide()},3000);var av=glock.x("bcst_status");if(av){switch(aw.bcst_status){case"broadcasting":av.removeClassName("bcst_status_idle");av.removeClassName("bcst_status_error");av.removeClassName("bcst_status_disabled");av.addClassName("bcst_status_running");av.innerHTML="broadcasting";break;case"idle":av.removeClassName("bcst_status_error");av.removeClassName("bcst_status_disabled");av.removeClassName("bcst_status_running");av.addClassName("bcst_status_idle");av.innerHTML="stand by";break}}}}})}var ac=glock.x("gsom_form_submit");glock.event.observe(ac,"click",P);var T=glock.x("gsom_varlist");if(T){var am=document.createDocumentFragment();glock.xA(window.gsom_fields).each(function(aq){am.appendChild(glock.builder.node("p",aq))});T.appendChild(am)}}function r(N){var Q=glock.x("gsom-mgr-subscribers");if(Q){var P=glock.x(Q.tHead.rows[0].cells[0]).down("input");if(P){glock.event.observe(P,"click",glock.xF(function(){d(this.checked)}).bindAsEventListener(P))}}var O=glock.x("gsom-btn-unsubscribe");if(O){glock.event.observe(O,"click",k)}O=glock.x("gsom-btn-delete");if(O){glock.event.observe(O,"click",K)}O=glock.x("gsom-search-btn");if(O){glock.event.observe(O,"click",function(){var T=glock.x("gsom-search-input");if(T){var V=T.value;gsomAppState.q=V;var U=glock.x("wpbody").down("ul.subsubsub");var R;if(U){R=U.select("a");for(var S=0;S<R.length;S++){if(glock.x(R[S]).hasClassName("current")){glock.x(R[S]).removeClassName("current")}}}O=glock.x("gsom-mgr-stype-all");if(O){O.addClassName("current")}j()}})}O=glock.x("gsom-search-input");if(O){glock.event.observe(O,"keyup",function(S){var R=S.element();if(R){if(S.keyCode==13){glock.x("gsom-search-btn").click()}}})}O=glock.x("gsom-search-cancel-btn");if(O){glock.event.observe(O,"click",function(){gsomAppState.q="";j();var R=glock.x("gsom-search-input");if(R){R.value=""}})}O=glock.x("gsom-btn-export");if(O){h({parent:O,items:[{caption:"Comma Separated Value (.csv)",onclick:function(){window.location=ajaxurl+"?action=gsom_export&to=csv&type="+gsomAppState.show+"&q="+gsomAppState.q}},{caption:"Excel XML Spreadsheet (.xml)",onclick:function(){window.location=ajaxurl+"?action=gsom_export&to=xml&type="+gsomAppState.show+"&q="+gsomAppState.q}}]});glock.event.observe(document.body,"click",glock.xF(function(T){var S=glock.event.element(T);var U=glock.x(S).up("ul.glbuttonddlist");if(U){return}if(glock.x(S).id=="gsom-btn-export"){return}var R=glock.x(document.body).down("ul.glbuttonddlist");if(R){if(glock.x(R).visible()){R.hide()}}}).bindAsEventListener(O))}O=glock.x("gsom-mgr-stype-all");if(O){glock.event.observe(O,"click",glock.xF(function(){u("all",this)}).bindAsEventListener(O))}O=glock.x("gsom-mgr-stype-confirmed");if(O){glock.event.observe(O,"click",glock.xF(function(){u("confirmed",this)}).bindAsEventListener(O))}O=glock.x("gsom-mgr-stype-unconfirmed");if(O){glock.event.observe(O,"click",glock.xF(function(){u("unconfirmed",this)}).bindAsEventListener(O))}O=glock.x("gsom-mgr-stype-unsubscribed");if(O){glock.event.observe(O,"click",glock.xF(function(){u("unsubscribed",this)}).bindAsEventListener(O))}j()}function M(S,N,P){var Q=glock.x(S),R;if(Q){glock.xA(N).each(function(T){if(glock.isObject(T)){R=glock.builder.node("option",{value:T.value},T.text)}else{R=glock.builder.node("option",{value:T},T)}Q.appendChild(R)});for(var O=0;O<Q.options.length;O++){if(Q.options[O].value==P){Q.selectedIndex=O}}}}function e(S){if(typeof S=="undefined"){S={}}var V=typeof S.all!="undefined"?S.all:0;var U=typeof S.unconfirmed!="undefined"?S.unconfirmed:0;var O=typeof S.confirmed!="undefined"?S.confirmed:0;var P=typeof S.unsubscribed!="undefined"?S.unsubscribed:0;var N=typeof S.q!="undefined"?S.q:false;btn=glock.x("gsom-mgr-stype-all");var R=glock.x(btn).up("ul");var T=glock.x("gsom-search-results-lbl");if(T){glock.element.remove(T);glock.element.remove(glock.x(R).down("br"))}if(N){if(R){var W=glock.x(btn).up("li");var Q=glock.builder.node("li",{id:"gsom-search-results-lbl"},'Search results for "'+N+'":');R.insertBefore(Q,W);Q=glock.builder.node("br");R.insertBefore(Q,W)}}if(btn){if(V>0){btn.innerHTML="All Subscribers ("+V+")"}else{btn.innerHTML="All Subscribers"}}btn=glock.x("gsom-mgr-stype-confirmed");if(btn){if(O>0){btn.innerHTML="Confirmed ("+O+")"}else{btn.innerHTML="Confirmed"}}btn=glock.x("gsom-mgr-stype-unconfirmed");if(btn){if(U>0){btn.innerHTML="Unconfirmed ("+U+")"}else{btn.innerHTML="Unconfirmed"}}btn=glock.x("gsom-mgr-stype-unsubscribed");if(btn){if(P>0){btn.innerHTML="Unsubscribed ("+P+")"}else{btn.innerHTML="Unsubscribed"}}}function u(Q,P){if(typeof Q=="undefined"){var Q="all"}if(!P){return}var R=glock.x("wpbody").down("ul.subsubsub");var N;if(R){N=R.select("a");for(var O=0;O<N.length;O++){if(glock.x(N[O]).hasClassName("current")){glock.x(N[O]).removeClassName("current")}}}glock.x(P).addClassName("current");j({show:Q})}function j(O){O=O||{};var Q=O.page||1,R=O.ipp||25,N=O.show||"all",P=gsomAppState.q||"";gsomAppState.page=Q;gsomAppState.ipp=R;gsomAppState.show=N;if(P){glock.x("gsom-search-cancel-btn").show()}else{glock.x("gsom-search-cancel-btn").hide()}o("gsom-mgr-subscribers");glock.ajax.makeRequest(ajaxurl,{method:"post",parameters:{action:"gsom_aj_get_subscribers",show:N,pg:Q,ipp:R,q:P},requestHeaders:{Accept:"application/json"},onComplete:function(T){if(200!=T.status){var S=glock.x("gsom-mgr-subscribers");if(!S){return}s(S,"Error")}},onSuccess:function(X){var U=glock.json.parse(X.responseText);if(U.state=="true"){var V=glock.x("gsom-mgr-subscribers");if(!V){return}var W=V.tBodies[0];if(!W){return}e({all:U.count.all,confirmed:U.count.confirmed,unconfirmed:U.count.unconfirmed,unsubscribed:U.count.unsubscribed,q:P});f(W);for(var T=0;T<U.rows.length;T++){W.appendChild(glock.builder.node("tr",{className:"alternate"},[glock.builder.node("th",{className:"check-column"},[glock.builder.node("input",{type:"checkbox",value:U.rows[T].id})]),glock.builder.node("td",U.rows[T].email),glock.builder.node("td",U.rows[T].time),glock.builder.node("td",U.rows[T].ip),glock.builder.node("td",D(U.rows[T].status)),glock.builder.node("td",B(U.rows[T].customData)||"")]))}if(U.rows.length==0){s(V)}if(U.pageCount>1){var S=glock.x("wpbody").select("div.tablenav-pages");if(S){for(T=0;T<S.length;T++){f(S[T]);w({bar:S[T],pageCount:U.pageCount,selectedPage:Q,ipp:R,onClick:j});S[T].appendChild(glock.builder.node("br",{className:"clear"}))}}}else{var S=glock.x("wpbody").select("div.tablenav-pages");if(S){for(T=0;T<S.length;T++){f(S[T])}}}}else{s(V)}}})}function B(P){var O,S,R,N;try{O=glock.json.parse(P)}catch(Q){return false}S=glock.builder.node("table",{className:"gsom_small_table"});R=glock.builder.node("tbody");S.appendChild(R);for(N=0;N<O.length;N++){R.appendChild(glock.builder.node("tr",[glock.builder.node("td",O[N].label),glock.builder.node("td",O[N].value)]))}return S}function D(N){if(N){switch(N){case"0":return"Unconfirmed";break;case"1":return"Confirmed";break;case"2":return"Unsubscribed";break}}}function w(U){if(typeof U=="undefined"){U={}}var T=typeof U.bar!="undefined"?U.bar:false;var Q=typeof U.pageCount!="undefined"?U.pageCount:1;var aa=typeof U.selectedPage!="undefined"?U.selectedPage:1;var ab=typeof U.ipp!="undefined"?U.ipp:25;var N=typeof U.style!="undefined"?U.style:"";var V=typeof U.onClick!="undefined"?U.onClick:false;var P="line-height: 26px; overflow:hidden; background: transparent url(/images/bform/thead_bg.png) repeat-x scroll 0 0; "+N;if(T===false){return}var O;var X;if(ab>0){if(aa!=1){O=glock.builder.node("a");O=glock.x(O);O.innerHTML="&laquo; Previous";O.addClassName("prev page-numbers");O.addClassName("gsom-flink");T.appendChild(O);if(V!==false){glock.event.observe(O,"click",function(){V({page:aa-1,ipp:ab,show:gsomAppState.show})})}}var Z=aa-1;var W=aa+1;var S=false;for(var R=1;R<=Q;R++){if(R<4){if(R==aa){O=glock.builder.node("span",R);T.appendChild(O);O=glock.x(O);O.addClassName("current")}else{O=glock.x(glock.builder.node("a",R));T.appendChild(O);if(V!==false){glock.event.observe(O,"click",glock.xF(function(){var ac=parseInt(this.innerHTML,10);V({page:ac,ipp:ab})}).bindAsEventListener(O))}}O.addClassName("page-numbers");O.addClassName("gsom-flink");S=false}else{if((R>=Z)&&(R<=W)){if(R==aa){O=glock.x(glock.builder.node("span",R));T.appendChild(O);O.addClassName("current")}else{O=glock.builder.node("a",R);T.appendChild(O);if(V!==false){glock.event.observe(O,"click",glock.xF(function(){var ac=parseInt(this.innerHTML,10);V({page:ac,ipp:ab})}).bindAsEventListener(O))}}O.addClassName("page-numbers");O.addClassName("gsom-flink");S=false}else{if(R>(Q-3)){if(R==aa){O=glock.x(glock.builder.node("span",R));T.appendChild(O);O.addClassName("current")}else{O=glock.builder.node("a",R);T.appendChild(O);if(V!==false){glock.event.observe(O,"click",glock.xF(function(){var ac=parseInt(this.innerHTML,10);V({page:ac,ipp:ab})}).bindAsEventListener(O))}}O.addClassName("page-numbers");O.addClassName("gsom-flink");S=false}else{if(!S){O=glock.x(glock.builder.node("span"));O.innerHTML="&#8230;";T.appendChild(O);O.addClassName("prev");O.addClassName("page-numbers");S=true}}}}}if(aa!=Q){O=glock.builder.node("a");O=glock.x(O);O.innerHTML="Next &raquo;";O.addClassName("next page-numbers");O.addClassName("gsom-flink");T.appendChild(O);if(V!==false){glock.event.observe(O,"click",function(){V({page:aa+1,ipp:ab})})}}}var Y=function(af){var ad=glock.builder.node("select",[glock.builder.node("option",{value:15},"15"),glock.builder.node("option",{value:25},"25"),glock.builder.node("option",{value:50},"50"),glock.builder.node("option",{value:100},"100"),glock.builder.node("option",{value:0},"All")]);var ac=false;for(var ae=0;ae<ad.length;ae++){if(ad.options[ae].value==af){ad.selectedIndex=ae;ac=true;break}}if(!ac){ad.appendChild(glock.builder.node("option",{value:af},String(af)))}glock.event.observe(ad,"change",glock.xF(function(){var ai=this.options[this.selectedIndex].value;if(ai){var ah=GetgsomAppStateObj();ah.ipp=ai;var ag=ah.StateFunction;ag(ah)}}).bindAsEventListener(ad));return ad}}function d(N){if(typeof N=="undefined"){var N=true}var Q=glock.x("gsom-mgr-subscribers");if(!Q){return}var R;var O=Q.select("th.check-column");for(var P=0;P<O.length;P++){R=glock.x(O[P]).down("input");if(R){R.checked=N}}}function K(){if(!confirm("Are you sure you want tot delete selected items?")){return}var Q=[];var P=glock.x("gsom-mgr-subscribers");if(!P){return}var R;var N=P.select("th.check-column");for(var O=0;O<N.length;O++){R=glock.x(N[O]).down("input");if(R){if((R.checked)&&(R.value!="on")){Q[Q.length]=R.value}}}glock.ajax.makeRequest(ajaxurl,{method:"post",parameters:{action:"gsom_aj_delete_subscriber",json:glock.json.stringify(Q)},requestHeaders:{Accept:"application/json"},onSuccess:function(T){var S=glock.json.parse(T.responseText);if(S.state=="true"){j({page:gsomAppState.page,ipp:gsomAppState.ipp,show:gsomAppState.show})}}});j({page:gsomAppState.page,ipp:gsomAppState.ipp,show:gsomAppState.show})}function k(){var Q=[];var P=glock.x("gsom-mgr-subscribers");if(!P){return}var R;var N=P.select("th.check-column");for(var O=0;O<N.length;O++){R=glock.x(N[O]).down("input");if(R){if((R.checked)&&(R.value!="on")){Q[Q.length]=R.value}}}glock.ajax.makeRequest(ajaxurl,{method:"post",parameters:{action:"gsom_aj_unsubscribe",json:glock.json.stringify(Q)},requestHeaders:{Accept:"application/json"},onSuccess:function(T){var S=glock.json.parse(T.responseText);if(S.state=="true"){j({page:gsomAppState.page,ipp:gsomAppState.ipp,show:gsomAppState.show})}}})}function o(P){var Q=glock.x(P);if(!Q){return}var N=glock.x("gsom-cbx-main");if(N){N.checked=false}var S=Q.tHead.rows[0].cells.length;var R=Q.tBodies[0];if(!R){return}f(R);var O=glock.builder.node("td",{align:"center",colspan:S},[glock.builder.node("div",{style:"overflow:hidden; width: 70px;"},[glock.builder.node("img",{style:"float:left;",src:"images/loading.gif"}),glock.builder.node("span",{style:"float:left; margin-left: 5px;"},"Loading")])]);O.colSpan=S;R.appendChild(glock.builder.node("tr",[O]))}function s(P,T){var Q=glock.x(P);T=T||"No Data To Display";if(!Q){return}var N=glock.x("gsom-cbx-main");if(N){N.checked=false}var S=Q.tHead.rows[0].cells.length;var R=Q.tBodies[0];if(!R){return}f(R);var O=glock.builder.node("td",{align:"center",colspan:S},"< "+T+" >");O.colSpan=S;R.appendChild(glock.builder.node("tr",[O]))}function A(V){if(typeof V=="undefined"){V={}}var S=V.on||false,O=V.id||"",Y=V.imgsrc||false,U=V.className||"",aa=V.onclick||false,T=V.onfinally||false,P=V.width||false,Z=V.caption||"Untitled",N=V.style||"",X=V.sw||false,R=glock.isDef(V.nativeStyle)?V.nativeStyle:true;this.listItems=typeof V.items!="undefined"?V.items:[];this.BuildList=function(ad){ad=ad||{};var ac=ad.items||false,ah=ad.left||0,ag=ad.top||0;this.lst=glock.builder.node("ul",{style:"display:none; left:"+ah+"px; top: "+ag+"px;",className:"glbuttonddlist"});for(var ae=0;ae<ac.length;ae++){var ab;var ai=new Date();var af="ddli"+ai.getTime();ab=glock.builder.node("div",{id:af,className:"glbuttonddlistitem"},ac[ae].caption);if(typeof ac[ae].onclick!="undefined"){glock.event.observe(ab,"click",ac[ae].onclick)}glock.event.observe(ab,"click",glock.xF(function(){glock.x(this).hide()}).bindAsEventListener(this.lst));this.lst.appendChild(glock.builder.node("li",[ab]))}document.body.appendChild(this.lst);glock.x(this.lst).show()};var Q,W;if(P){if(P=="def"){W="width:50px;"}else{if(!R){P-=10}W="width:"+(P)+"px; "}}else{W=""}if(R){W+=" overflow: hidden;"}if(Y){Q=glock.builder.node("img",{className:"bbico",src:Y})}if(!S){cname="glbutton "+U}else{cname="glbutton_on "+U}if(!R){this.ibtn=glock.builder.node("div",{className:cname,style:N,id:O},[glock.builder.node("div",{className:"bbleftside"}),glock.builder.node("div",{className:"bbmiddle",style:W},[Q,glock.builder.node("span",{style:"float:left;"},Z),glock.builder.node("img",{style:"margin-left:3px; margin-top: 11px; float:left;",src:gsomPluginPath+"img/darrow.gif"})]),glock.builder.node("div",{className:"bbrightside"})])}else{this.ibtn=glock.builder.node("div",{className:"button",style:W},[Q,glock.builder.node("span",{style:"float:left;"},Z),glock.builder.node("img",{style:"margin-left:3px; margin-top: 6px; float:left;",src:gsomPluginPath+"img/darrow.gif"})])}if(aa){glock.event.observe(this.ibtn,"click",aa)}if(T){glock.event.observe(this.ibtn,"click",T)}if(X){glock.event.observe(this.ibtn,"click",glock.xF(function(){if(glock.x(this).hasClassName("glbutton_on")){glock.x(this).removeClassName("glbutton_on").addClassName("glbutton")}else{glock.x(this).removeClassName("glbutton").addClassName("glbutton_on")}}).bindAsEventListener(this.ibtn))}glock.event.observe(this.ibtn,"mouseover",glock.xF(function(){if(glock.x(this).hasClassName("glbutton")){glock.x(this).removeClassName("glbutton").addClassName("glbutton_act")}}).bindAsEventListener(this.ibtn));glock.event.observe(this.ibtn,"mouseout",function(){if(glock.x(this).hasClassName("glbutton_act")){glock.x(this).removeClassName("glbutton_act").addClassName("glbutton")}});glock.event.observe(this.ibtn,"click",glock.xF(function(){if(this.lst){glock.x(this.lst).toggle();return}var ab=this.ibtn;if(ab){var ac=glock.element.positionedOffset(ab);ac.top+=glock.element.getHeight(ab)+1}this.BuildList({items:this.listItems,left:ac.left,top:ac.top})}).bindAsEventListener(this));glock.event.observe(document,"click",glock.xF(function(ad){var ab=glock.event.pointer(ad).x,ae=glock.event.pointer(ad).y;glock.ui.position.prepare();if(this.ibtn&&this.lst&&!glock.ui.position.withinIncludingScrolloffsets(this.ibtn,ab,ae)&&!glock.ui.position.withinIncludingScrolloffsets(this.lst,ab,ae)){if(this.lst){var ac=glock.x(this.lst);if(ac.visible()){ac.hide()}}}}).bindAsEventListener(this));return this}function h(N){N=N||{};var P=N.parent||false;this.listItems=N.items||[];this.ibtn=glock.x(P);this.BuildList=function(S){S=S||{};var R=S.items||false,W=S.left||0,V=S.top||0;this.lst=glock.builder.node("ul",{style:"display:none; left:"+W+"px; top: "+V+"px;",className:"glbuttonddlist"});for(var T=0;T<R.length;T++){var Q;var X=new Date();var U="ddli"+X.getTime();Q=glock.builder.node("div",{id:U,className:"glbuttonddlistitem"},R[T].caption);if(typeof R[T].onclick!="undefined"){glock.event.observe(Q,"click",R[T].onclick)}glock.event.observe(Q,"click",glock.xF(function(){glock.x(this).hide()}).bindAsEventListener(this.lst));this.lst.appendChild(glock.builder.node("li",[Q]))}document.body.appendChild(this.lst);glock.x(this.lst).show()};var O;glock.event.observe(this.ibtn,"click",glock.xF(function(){if(this.lst){glock.x(this.lst).toggle();return}var Q=this.ibtn;if(Q){var R=glock.element.positionedOffset(Q);R.top+=glock.element.getHeight(Q)+1}this.BuildList({items:this.listItems,left:R.left,top:R.top})}).bindAsEventListener(this));return this}function q(T){T=T||{};var S=T.fieldId||"",U=(!S)?"add":"edit",X=T.oldItem||false,N="",O="";if(X){U="edit";N=glock.x(X).down("input").value;O=""}if(U=="add"){caption="Add Text Field"}else{caption="Edit Subscribe Button"}var R=T.onSaveClick||false;var P=glock.builder.node("div",{className:"bform"});P.style.width="325px";P.appendChild(glock.builder.node("div",{className:"handle"},[glock.builder.node("div",[glock.builder.node("div",{className:"bform-lt"},[glock.builder.node("div",{className:"bform-rt"},[glock.builder.node("div",{className:"bform-t"})])])]),glock.builder.node("div",[glock.builder.node("div",{className:"bform-l"},[glock.builder.node("div",{className:"bform-r"},[glock.builder.node("div",{className:"bform-header"},[glock.builder.node("div",{style:"float:left"},caption),glock.builder.node("div",{className:"bform-closebutton"})])])])])]));P.appendChild(glock.builder.node("div",[glock.builder.node("div",{className:"bform-l"},[glock.builder.node("div",{className:"bform-r"},[glock.builder.node("div",{className:"bform-body"})])])]));P.appendChild(glock.builder.node("div",[glock.builder.node("div",{className:"bform-lb"},[glock.builder.node("div",{className:"bform-rb"},[glock.builder.node("div",{className:"bform-b"})])])]));var W=glock.builder.node("div",{style:"margin:20px 0px"},[glock.builder.node("ul",{className:"bform-list"},[glock.builder.node("li",[glock.builder.node("label","Label:"),glock.builder.node("input",{name:"flabel",type:"edit",value:N})]),glock.builder.node("li",[glock.builder.node("input",{name:"id",type:"hidden"}),glock.builder.node("div",{className:"btngroup",style:"overflow:hidden;"},[H({caption:"OK",nativeStyle:false,onclick:function(){var Z=P.select("input");var ad,aa;var Y="submit";for(var ab=0;ab<Z.length;ab++){if(Z[ab].name=="flabel"){ad=Z[ab].value}}var ac=C({ul:"gsom-fields-list",oldItem:X,label:aa,type:Y,value:ad,name:"gsomsubscribe"});if(ac){var ae=J.bind(P);ae();glock.ui.makeSortable("gsom-fields-list",{handle:"gsom-list-item-wrapper",onUpdate:b,markDropZone:true,dropOnEmpty:true});b()}},width:"def"}),H({caption:"Cancel",nativeStyle:false,onclick:glock.xF(J).bindAsEventListener(P),width:"def"})])])])]);document.body.appendChild(P);glock.x(P).down("div.bform-body").appendChild(W);glock.event.observe(glock.x(P.down("div.bform-closebutton")),"click",glock.xF(J).bindAsEventListener(P));var V=Math.round(glock.viewport.getWidth()/2)-Math.round(glock.x(P).getWidth()/2);var Q=glock.viewport.getScrollOffsets().top+Math.round(glock.viewport.getHeight()/2)-Math.round(glock.x(P).getHeight()/2);P.style.top=Q+"px";P.style.left=V+"px";glock.ui.makeDraggable(P,{handle:"handle"})}function z(T){T=T||{};var S=T.fieldId||"",U=(!S)?"add":"edit",X=T.oldItem||false,N="",O="",R=T.onSaveClick||false;if(X){U="edit";N=glock.x(X).down("label").innerHTML;O=glock.x(X).down("input").value}if(U=="add"){caption="Add Text Field"}else{caption="Edit Text Field"}var P=glock.builder.node("div",{className:"bform"});P.style.width="325px";P.appendChild(glock.builder.node("div",{className:"handle"},[glock.builder.node("div",[glock.builder.node("div",{className:"bform-lt"},[glock.builder.node("div",{className:"bform-rt"},[glock.builder.node("div",{className:"bform-t"})])])]),glock.builder.node("div",[glock.builder.node("div",{className:"bform-l"},[glock.builder.node("div",{className:"bform-r"},[glock.builder.node("div",{className:"bform-header"},[glock.builder.node("div",{style:"float:left"},caption),glock.builder.node("div",{className:"bform-closebutton"})])])])])]));P.appendChild(glock.builder.node("div",[glock.builder.node("div",{className:"bform-l"},[glock.builder.node("div",{className:"bform-r"},[glock.builder.node("div",{className:"bform-body"})])])]));P.appendChild(glock.builder.node("div",[glock.builder.node("div",{className:"bform-lb"},[glock.builder.node("div",{className:"bform-rb"},[glock.builder.node("div",{className:"bform-b"})])])]));var W=glock.builder.node("div",{style:"margin:20px 0px"},[glock.builder.node("ul",{className:"bform-list"},[glock.builder.node("li",[glock.builder.node("label","Label:"),glock.builder.node("input",{name:"flabel",type:"edit",value:N})]),glock.builder.node("li",[glock.builder.node("label","Default value:"),glock.builder.node("input",{name:"fvalue",type:"edit",value:O})]),glock.builder.node("li",[glock.builder.node("input",{name:"id",type:"hidden"}),glock.builder.node("div",{className:"btngroup",style:"overflow:hidden;"},[H({caption:"OK",nativeStyle:false,onclick:function(){var Z=P.select("input");var ad,aa;var Y="text";for(var ab=0;ab<Z.length;ab++){if(Z[ab].name=="flabel"){aa=Z[ab].value}if(Z[ab].name=="fvalue"){ad=Z[ab].value}}var ac=C({ul:"gsom-fields-list",oldItem:X,label:aa,type:Y,value:ad});if(ac){var ae=J.bind(P);ae();glock.ui.makeSortable("gsom-fields-list",{handle:"gsom-list-item-wrapper",onUpdate:b,markDropZone:true,dropOnEmpty:true});b()}},width:"def"}),H({caption:"Cancel",nativeStyle:false,onclick:glock.xF(J).bindAsEventListener(P),width:"def"})])])])]);document.body.appendChild(P);glock.x(P).down("div.bform-body").appendChild(W);glock.event.observe(glock.x(P.down("div.bform-closebutton")),"click",glock.xF(J).bindAsEventListener(P));var V=Math.round(glock.viewport.getWidth()/2)-Math.round(glock.x(P).getWidth()/2);var Q=glock.viewport.getScrollOffsets().top+Math.round(glock.viewport.getHeight()/2)-Math.round(glock.x(P).getHeight()/2);P.style.top=Q+"px";P.style.left=V+"px";glock.ui.makeDraggable(P,{handle:"handle"})}function L(T){T=T||{};var S=T.fieldId||"",N=glock.x(S).down("label");if(!N){return}var O=N.innerHTML,W="Edit Text Field",R=T.onSaveClick||false;var P=glock.builder.node("div",{className:"bform"});P.style.width="325px";P.appendChild(glock.builder.node("div",{className:"handle"},[glock.builder.node("div",[glock.builder.node("div",{className:"bform-lt"},[glock.builder.node("div",{className:"bform-rt"},[glock.builder.node("div",{className:"bform-t"})])])]),glock.builder.node("div",[glock.builder.node("div",{className:"bform-l"},[glock.builder.node("div",{className:"bform-r"},[glock.builder.node("div",{className:"bform-header"},[glock.builder.node("div",{style:"float:left"},W),glock.builder.node("div",{className:"bform-closebutton"})])])])])]));P.appendChild(glock.builder.node("div",[glock.builder.node("div",{className:"bform-l"},[glock.builder.node("div",{className:"bform-r"},[glock.builder.node("div",{className:"bform-body"})])])]));P.appendChild(glock.builder.node("div",[glock.builder.node("div",{className:"bform-lb"},[glock.builder.node("div",{className:"bform-rb"},[glock.builder.node("div",{className:"bform-b"})])])]));var V=glock.builder.node("div",{style:"margin:20px 0px"},[glock.builder.node("ul",{className:"bform-list"},[glock.builder.node("li",[glock.builder.node("label","Label:"),glock.builder.node("input",{name:"flabel",type:"edit",value:O})]),glock.builder.node("li",[glock.builder.node("input",{name:"id",type:"hidden"}),glock.builder.node("div",{className:"btngroup",style:"overflow:hidden;"},[H({caption:"OK",nativeStyle:false,onclick:function(){var X=P.down("input");N.update(X.value);var Y=J.bind(P);Y();glock.ui.makeSortable("gsom-fields-list",{handle:"gsom-list-item-wrapper",onUpdate:b,markDropZone:true,dropOnEmpty:true});b()},width:"def"}),H({caption:"Cancel",nativeStyle:false,onclick:glock.xF(J).bindAsEventListener(P),width:"def"})])])])]);document.body.appendChild(P);glock.x(P).down("div.bform-body").appendChild(V);glock.event.observe(glock.x(P.down("div.bform-closebutton")),"click",glock.xF(J).bindAsEventListener(P));var U=Math.round(glock.viewport.getWidth()/2)-Math.round(glock.x(P).getWidth()/2);var Q=glock.viewport.getScrollOffsets().top+Math.round(glock.viewport.getHeight()/2)-Math.round(glock.x(P).getHeight()/2);P.style.top=Q+"px";P.style.left=U+"px";glock.ui.makeDraggable(P,{handle:"handle"})}function I(U){U=U||{};var S=U.fieldId||"",V=(!S)?"add":"edit",aa=U.oldItem||false,O="",T=false,Z="",R=U.onSaveClick||false;if(aa){V="edit";var W=glock.x(aa);if(W){O=W.down("label").innerHTML;T=W.down("input").checked}}if(V=="add"){Z="Add Checkbox"}else{Z="Edit Checkbox"}var P=glock.builder.node("div",{className:"bform"});P.style.width="325px";P.appendChild(glock.builder.node("div",{className:"handle"},[glock.builder.node("div",[glock.builder.node("div",{className:"bform-lt"},[glock.builder.node("div",{className:"bform-rt"},[glock.builder.node("div",{className:"bform-t"})])])]),glock.builder.node("div",[glock.builder.node("div",{className:"bform-l"},[glock.builder.node("div",{className:"bform-r"},[glock.builder.node("div",{className:"bform-header"},[glock.builder.node("div",{style:"float:left"},Z),glock.builder.node("div",{className:"bform-closebutton"})])])])])]));P.appendChild(glock.builder.node("div",[glock.builder.node("div",{className:"bform-l"},[glock.builder.node("div",{className:"bform-r"},[glock.builder.node("div",{className:"bform-body"})])])]));P.appendChild(glock.builder.node("div",[glock.builder.node("div",{className:"bform-lb"},[glock.builder.node("div",{className:"bform-rb"},[glock.builder.node("div",{className:"bform-b"})])])]));var N={name:"fchecked",type:"checkbox"};if(T){N.checked="checked"}var Y=glock.builder.node("div",{style:"margin:20px 0px"},[glock.builder.node("ul",{className:"bform-list"},[glock.builder.node("li",[glock.builder.node("label","Label:"),glock.builder.node("input",{name:"flabel",type:"edit",value:O})]),glock.builder.node("li",[glock.builder.node("label","Checked:"),glock.builder.node("input",N)]),glock.builder.node("li",[glock.builder.node("input",{name:"id",type:"hidden"}),glock.builder.node("div",{className:"btngroup",style:"overflow:hidden;"},[H({caption:"OK",nativeStyle:false,onclick:function(){var ad=P.select("input");var ah,ae,ac;var ab="checkbox";for(var af=0;af<ad.length;af++){if(ad[af].name=="flabel"){ae=ad[af].value}if(ad[af].name=="fchecked"){ac=ad[af].checked}}var ag=C({ul:"gsom-fields-list",oldItem:aa,label:ae,type:ab,checked:ac});if(ag){var ai=J.bind(P);ai();glock.ui.makeSortable("gsom-fields-list",{handle:"gsom-list-item-wrapper",onUpdate:b,markDropZone:true,dropOnEmpty:true});b()}},width:"def"}),H({caption:"Cancel",nativeStyle:false,onclick:glock.xF(J).bindAsEventListener(P),width:"def"})])])])]);document.body.appendChild(P);glock.x(P).down("div.bform-body").appendChild(Y);glock.event.observe(glock.x(P.down("div.bform-closebutton")),"click",glock.xF(J).bindAsEventListener(P));var X=Math.round(glock.viewport.getWidth()/2)-Math.round(glock.x(P).getWidth()/2);var Q=glock.viewport.getScrollOffsets().top+Math.round(glock.viewport.getHeight()/2)-Math.round(glock.x(P).getHeight()/2);P.style.top=Q+"px";P.style.left=X+"px";glock.ui.makeDraggable(P,{handle:"handle"})}function g(Q){Q=Q||{};var S=Q.parent||"",P=Q.label||"",O=Q.checked||false,R,N;N={className:"radio",style:"float:left;",type:"radio",name:"gsom-temp-radio"};if(O){N.checked="checked"}var T="rbrid"+Math.floor(Math.random()*101);R=glock.builder.node("li",{id:T,style:"clear:both; overflow:hidden;"},[glock.builder.node("input",N),glock.builder.node("input",{className:"lbl",style:"float:left;",type:"text",value:P}),n({imgsrc:gsomPluginPath+"img/delete.png",onclick:function(){if(confirm("Are you sure you want to delete this item?")){var U=glock.x(T);glock.element.remove(U)}}})]);if(S){glock.x(S).appendChild(R);return true}else{return R}}function l(V){V=V||{};var U=V.fieldId||"",X=(!U)?"add":"edit",ab=V.oldItem||false,N="",T=V.onSaveClick||false;if(ab){X="edit";N=glock.x(ab).down("label").innerHTML}if(X=="add"){caption="Add Radio Group"}else{caption="Edit Radio Group"}var O=glock.builder.node("div",{className:"bform"});O.style.width="345px";O.appendChild(glock.builder.node("div",{className:"handle"},[glock.builder.node("div",[glock.builder.node("div",{className:"bform-lt"},[glock.builder.node("div",{className:"bform-rt"},[glock.builder.node("div",{className:"bform-t"})])])]),glock.builder.node("div",[glock.builder.node("div",{className:"bform-l"},[glock.builder.node("div",{className:"bform-r"},[glock.builder.node("div",{className:"bform-header"},[glock.builder.node("div",{style:"float:left"},caption),glock.builder.node("div",{className:"bform-closebutton"})])])])])]));O.appendChild(glock.builder.node("div",[glock.builder.node("div",{className:"bform-l"},[glock.builder.node("div",{className:"bform-r"},[glock.builder.node("div",{className:"bform-body"})])])]));O.appendChild(glock.builder.node("div",[glock.builder.node("div",{className:"bform-lb"},[glock.builder.node("div",{className:"bform-rb"},[glock.builder.node("div",{className:"bform-b"})])])]));var aa=glock.builder.node("div",{style:"margin:20px 0px 10px 0px;"},[glock.builder.node("ul",{className:"bform-list"},[glock.builder.node("li",[glock.builder.node("label","Label:"),glock.builder.node("input",{id:"flabel",name:"flabel",type:"edit",value:N})]),glock.builder.node("li",{style:"overflow:hidden;"},[n({imgsrc:gsomPluginPath+"img/add.png",style:"float:left;",onclick:function(){g({parent:glock.x(aa).down("ul.bform-rb-list")})}}),glock.builder.node("label","Radio Buttons:"),glock.builder.node("ul",{className:"bform-rb-list"})]),glock.builder.node("li",{style:"margin-top:20px;"},[glock.builder.node("input",{name:"id",type:"hidden"}),glock.builder.node("div",{className:"btngroup",style:"overflow:hidden;"},[H({caption:"OK",nativeStyle:false,onclick:function(){var ae=O.select("ul.bform-rb-list li"),ac=[],af,ad="radio";af=glock.x("flabel").value;for(var ag=0;ag<ae.length;ag++){ac[ac.length]={label:ae[ag].down("input.lbl").value,checked:ae[ag].down("input.radio").checked}}var ah=C({ul:"gsom-fields-list",oldItem:ab,label:af,type:ad,value:ac});if(ah){var ai=J.bind(O);ai();glock.ui.makeSortable("gsom-fields-list",{handle:"gsom-list-item-wrapper",onUpdate:b,markDropZone:true,dropOnEmpty:true});b()}},width:"def"}),H({caption:"Cancel",nativeStyle:false,onclick:glock.xF(J).bindAsEventListener(O),width:"def"})])])])]);document.body.appendChild(O);glock.x(O).down("div.bform-body").appendChild(aa);var R=glock.x(aa).down("ul.bform-rb-list");if(R){if(ab){var Y=glock.x(ab).select("input");if(Y){for(var S=0;S<Y.length;S++){var P=Y[S].checked;var W=glock.element.nextSiblings(Y[S])[0].innerHTML;R.appendChild(g({label:W,checked:P}))}}}else{R.appendChild(g())}}glock.event.observe(glock.x(O.down("div.bform-closebutton")),"click",glock.xF(J).bindAsEventListener(O));var Z=Math.round(glock.viewport.getWidth()/2)-Math.round(glock.x(O).getWidth()/2);var Q=glock.viewport.getScrollOffsets().top+Math.round(glock.viewport.getHeight()/2)-Math.round(glock.x(O).getHeight()/2);O.style.top=Q+"px";O.style.left=Z+"px";glock.ui.makeDraggable(O,{handle:"handle"})}function b(){var N=[],Q,P,Y,ae="",S,Z=glock.x("gsom-fields-list");if(Z){var V=glock.builder.node("div");function T(af){V.appendChild(glock.builder.node("p",{style:"margin: 5px 0;"},af))}glock.xA(["$blog_name","$blog_url","$from_email","$from_name","$manage_subscription_link","$confirmation_link","$resend_confirmation_link","$encoded_email","$decoded_email","$subscription_time","$subscriber_ip"]).each(T);var U=glock.x(Z).select("li");if(U){for(var X=0;X<U.length;X++){Y=U[X].down("label");label=Y?Y.innerHTML:"";S=U[X].down("span.gsom-oldname");if(S){ae=S.innerHTML}else{ae=""}Q=U[X].select("input");if(Q.length>1){var R=[],ad;for(var W=0;W<Q.length;W++){ad=glock.x(Q[W]).nextSiblings();R[R.length]={label:(ad[0])?ad[0].innerHTML:"",checked:Q[W].checked}}N[N.length]={label:label,name:Q[0].name,oldName:ae,value:R,type:"radio"};V.appendChild(glock.builder.node("p",{style:"margin: 5px 0;"},"$"+Q[0].name))}else{P=Q[0];if(P){var O=P.type;if(P.type.toLowerCase()=="button"){O="submit"}var ab={label:label,name:P.name,oldName:ae,value:P.value,type:O};if(P.type.toLowerCase()=="checkbox"){ab.checked=P.checked}N[N.length]=ab;if(P.name!="gsomsubscribe"){V.appendChild(glock.builder.node("p",{style:"margin: 5px 0;"},"$"+P.name))}}}}}var ac=glock.xx("div.gsom-varlist");for(var X=0;X<ac.length;X++){ac[X].innerHTML=V.innerHTML}}var aa=glock.x("gsom-json-serialized-form");if(aa){aa.value=glock.json.stringify(N)}}function p(){var N=glock.x(this);if(N){if(confirm("Are you sure you want to delete this item?")){glock.element.remove(N);b()}}}function n(O){O=O||{};var R=O.imgsrc||false,Q=O.className||"",N=O.onclick||false,P=O.style||"";P+=" display:block; margin-top:2px; cursor: pointer;";var S=glock.builder.node("img",{src:R,style:P});if(N){glock.event.observe(S,"click",N)}return S}function H(U){U=U||{};var R=U.on||false,Y=U.imgsrc||false,T=U.className||"",Z=U.onclick||false,S=U.onfinally||false,O=U.width||false,aa=U.caption||"Untitled",N=U.style||"",X=U.sw||false,Q,P=glock.isDef(U.nativeStyle)?U.nativeStyle:true,V;if(O){if(O=="def"){V="width:50px;"}else{if(!P){O-=10}V="width:"+(O)+"px; margin: 2px;"}}else{V=""}if(Y){Q=glock.builder.node("img",{className:"bbico",src:Y})}if(!R){cname="glbutton "+T}else{cname="glbutton_on "+T}var W;if(!P){W=glock.builder.node("div",{className:cname,style:N},[glock.builder.node("div",{className:"bbleftside"}),glock.builder.node("div",{className:"bbmiddle",style:V},[Q,glock.builder.node("span",{style:"float:none; margin: 0; padding: 0; display:block;"},aa)]),glock.builder.node("div",{className:"bbrightside"})])}else{W=glock.builder.node("button",{className:"button",type:"button",style:V},aa)}if(Z){glock.event.observe(W,"click",Z)}if(S){glock.event.observe(W,"click",S)}if(X){glock.event.observe(W,"click",glock.xF(function(){if(glock.x(this).hasClassName("glbutton_on")){glock.x(this).removeClassName("glbutton_on").addClassName("glbutton")}else{glock.x(this).removeClassName("glbutton").addClassName("glbutton_on")}}).bindAsEventListener(W))}glock.event.observe(W,"mouseover",glock.xF(function(){if(glock.x(this).hasClassName("glbutton")){glock.x(this).removeClassName("glbutton").addClassName("glbutton_act")}}).bindAsEventListener(W));glock.event.observe(W,"mouseout",function(){if(glock.x(this).hasClassName("glbutton_act")){glock.x(this).removeClassName("glbutton_act").addClassName("glbutton")}});return W}function J(){var O=glock.x(this).select("input");if(O){for(i=0;i<O.length;i++){if(O[i].name=="endDate"||O[i].name=="startDate"){var N=datePickers.get(O[i].id);if(N){N.close()}}}}f(this);glock.element.remove(this)}function f(N){while(N.childNodes[0]){N.removeChild(N.childNodes[0])}}E.adminBuildForm=F;E.gsomInit=x;E.SerializeForm=b;E.InitBroadcast=a;E.mdoChange=c;E.initManager=r;return E})();