/*
 * Glock.js {version}
 * Copyright(c) 2006-{[new Date().format('Y')]}, {company}
 * {contactEmail}
 * {site}
 */
if(typeof glock=="undefined"){var glock={}}if(typeof glock.ui=="undefined"){glock.ui={}}glock.ui.flatButton=function(j){if(!j){j={}}var k=glock.builder.node.bind(glock.builder),m=typeof j.imgsrc!=="undefined"?j.imgsrc:false,o=typeof j.onclick!=="undefined"?j.onclick:false,e=typeof j.width!=="undefined"?j.width:false,p=typeof j.caption!=="undefined"?j.caption:"Untitled",g=typeof j.captionStyle!=="undefined"?j.captionStyle:"",h=typeof j.captionClassName!=="undefined"?j.captionClassName:"",i=typeof j.className!=="undefined"?j.className:"",d=typeof j.style!=="undefined"?j.style:"",a=typeof j.highLight!=="undefined"?j.highLight:true,f,l=e?" width:"+e+"px;":"",n;g=g+" ";if(m){f=k("img",{className:"glfb-ico",src:m})}ibtn=k("div",{className:"gl-flat-btn "+i,style:d},[k("div",{className:"glfb-leftside"}),k("div",{className:"glfb-middle",style:l},[f,k("span",{style:g,className:h},p)]),k("div",{className:"glfb-rightside"})]);if(o){glock.event.observe(ibtn,"click",o,true)}if(a){glock.event.observe(ibtn,"mouseover",function(){glock.x(this).addClassName("gl-flat-btn-act")}.bindAsEventListener(ibtn));glock.event.observe(ibtn,"mouseout",function(){if(glock.x(this).hasClassName("gl-flat-btn-act")){glock.x(this).removeClassName("gl-flat-btn-act")}})}return ibtn};glock.ui.disableSelection=function(a){a.onselectstart=function(){return false};a.unselectable="on";a.style.MozUserSelect="none"};glock.ui.popupMenu=function(b){that={};if(!b){b={}}var d=typeof b.parent!=="undefined"?b.parent:false,e=typeof b.items!=="undefined"?b.items:[],f=glock.x(d),a;that.BuildList=function(l){if(!l){l={}}var o=glock.builder.node.bind(glock.builder),m=glock.isDef(l.items)?l.items:false,h=glock.isDef(l.left)?l.left:0,n=glock.isDef(l.top)?l.top:0,g;a=glock.builder.node("ul",{style:"display:none; left:"+h+"px; top: "+n+"px;",className:"gl-dropdown"});for(var j=0;j<m.length;j++){var p;var k=new Date();var q="ddli"+k.getTime();p=o("div",{id:q,className:"gl-dropdown-item"},m[j].caption);if(typeof m[j].onclick!=="undefined"){glock.event.observe(p,"click",m[j].onclick)}glock.event.observe(p,"click",function(){glock.x(this).hide()}.bindAsEventListener(a));a.appendChild(o("li",[p]))}document.body.appendChild(a);a.show()};glock.event.observe(f,"click",glock.xf(function(){if(a){if(glock.x(a).visible()){a.hide()}else{a.show()}return}var g=f;if(g){var h=glock.element.positionedOffset(g);h.top+=glock.element.getHeight(g)+1}this.BuildList({items:this.listItems,left:h.left,top:h.top})}).bindAsEventListener(that));glock.event.observe(document.body,"click",function(h){var g=glock.event.element(h);var i=glock.x(g).up("ul.gl-dropdown");if(i){return}if(a){if(glock.x(a).visible()){a.hide()}}}.bindAsEventListener(that));return that};glock.ui.position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},within:function(b,a,e){if(!glock.isNumber(a)){var d=glock.ui.position.cursor(a);a=d.x;e=d.y}if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(b,a,e)}this.xcomp=a;this.ycomp=e;this.offset=glock.element.cumulativeOffset(b);return(e>=this.offset[1]&&e<this.offset[1]+b.offsetHeight&&a>=this.offset[0]&&a<this.offset[0]+b.offsetWidth)},withinIncludingScrolloffsets:function(e,b,i){var g=glock.element.cumulativeScrollOffset(e);this.xcomp=b+g[0]-this.deltaX;this.ycomp=i+g[1]-this.deltaY;this.offset=glock.element.cumulativeOffset(e);var a=glock.x(e).getDimensions(),f=a.height,d=a.width;return(this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+f&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+d)},overlap:function(b,a){if(!b){return 0}if(b=="vertical"){return((this.offset[1]+a.offsetHeight)-this.ycomp)/a.offsetHeight}if(b=="horizontal"){return((this.offset[0]+a.offsetWidth)-this.xcomp)/a.offsetWidth}},cumulativeOffset:glock.element.cumulativeOffset,positionedOffset:glock.element.positionedOffset,absolutize:function(a){glock.ui.position.prepare();return glock.element.absolutize(a)},relativize:function(a){glock.ui.position.prepare();return glock.element.relativize(a)},realOffset:glock.element.cumulativeScrollOffset,offsetParent:glock.element.getOffsetParent,page:glock.element.viewportOffset,clone:function(b,d,a){a=a||{};return glock.element.clonePosition(d,b,a)},cursor:function(a){a=a||window.event;var b={x:0,y:0};if(a.pageX||a.pageY){b.x=a.pageX;b.y=a.pageY}else{b.x=a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft;b.y=a.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop}return b}};glock.ui.DDManager={draggables:[],droppables:[],sortables:[],notifyDroppables:function(a,b){b=b||[];glock.xA(this.droppables).each(function(d){d[a].apply(d,b)})}};glock.ui.makeDraggable=function(e,d){var f={};f.element=glock.x(e);if(!f.element){return false}f.options={handle:false,zindex:1000,absolutize:false,constraint:"",revert:false,ghosting:false,startEffect:false,revertEffect:false,endEffect:false,onStart:false,onDrag:false,onEnd:false};var b=false;glock.extObj(f.options,arguments[1]||{});function g(j){f._dragging=true;if(f.options.absolutize){f.oldPlaceHolder=glock.builder.node(f.element.nodeName,{style:"visibility:hidden;"});glock.element.clonePosition(f.oldPlaceHolder,f.element);f.oldPlaceHolder=glock.x(f.oldPlaceHolder)}f.initialElemPosLeft=f.element.getStyleLeft();f.initialElemPosTop=f.element.getStyleTop();f.initialMouseX=glock.event.pointerX(j);f.initialMouseY=glock.event.pointerY(j);f._position=f.element.getStyle("position")||"";if(f.options.absolutize){glock.element.absolutize(f.element);f.oldPlaceHolder.insertEl("after",f.element)}else{glock.element.makePositioned(f.element)}f.initialElemAbsPosLeft=f.element.getStyleLeft();f.initialElemAbsPosTop=f.element.getStyleTop();f.initialZIndex=f.element.getStyle("z-index")||0;f.element.style.zIndex=f.options.zindex;glock.event.stop(j);return false}function i(k){if(f._dragging){f._dragging=false;b=false;f.element.style.zIndex=f.initialZIndex;var j=glock.event.pointerX(k),l=glock.event.pointerY(k);if(f.options.absolutize){f.element.insertEl("before",f.oldPlaceHolder);glock.element.remove(f.oldPlaceHolder)}if(f.options.revert){if(f.options.absolutize){glock.element.undoAbsolutize(f.element)}else{glock.element.undoPositioned(f.element)}f.element.style.left=(f.initialElemPosLeft||0)+"px";f.element.style.top=(f.initialElemPosTop||0)+"px"}f.element.style.position=f._position;if(glock.isFunction(f.options.onEnd)){f.options.onEnd(f,k)}glock.ui.DDManager.notifyDroppables("dropHandler",[{x:j,y:l},f,k])}glock.event.stop(k);return false}function h(l){if(f._dragging){if(!b){if(glock.isFunction(f.options.onStart)){f.options.onStart(f,l)}b=true}var k=glock.event.element(l);var j=glock.event.pointerX(l),m=glock.event.pointerY(l);switch(f.options.constraint){case"vertical":f.element.style.top=(f.initialElemAbsPosTop+m-f.initialMouseY)+"px";break;case"horizontal":f.element.style.left=(f.initialElemAbsPosLeft+j-f.initialMouseX)+"px";break;default:f.element.style.top=(f.initialElemAbsPosTop+m-f.initialMouseY)+"px";f.element.style.left=(f.initialElemAbsPosLeft+j-f.initialMouseX)+"px";break}glock.ui.DDManager.notifyDroppables("dragHandler",[{x:j,y:m},f,l]);if(glock.isFunction(f.options.onDrag)){f.options.onDrag(f,l)}glock.event.stop(l);return false}}f.resetCounters=function(l,k){var j=glock.event.pointerX(l),m=glock.event.pointerY(l);if(k){f.initialMouseY+=f.element.getHeight()}else{f.initialMouseY-=f.element.getHeight()}f.element.style.top=(f.initialElemPosTop+m-f.initialMouseY)+"px"};glock.ui.DDManager.draggables.push(f);var a=(f.options.handle)?(f.element.down("."+f.options.handle)||f.element):f.element;glock.event.observe(a,"mousedown",glock.xF(g).bindAsEventListener(f));glock.event.observe(document,"mouseup",glock.xF(i).bindAsEventListener(f));glock.event.observe(document,"mousemove",glock.xF(h).bindAsEventListener(f));return f};glock.ui.makeDroppable=function(d,b){var e={};e.element=glock.x(d);if(!e.element){return false}e.options={accept:"",containment:"",hoverclass:"",greedy:true,onHover:false,onDrop:false};e.movedOut=false;function g(h,i,j){if(!glock.ui.position.within(e.element,h.x,h.y)){return false}if((e.element!=i.element)&&((!e.options.accept)||(glock.xW(i.element.className).detect(function(k){return glock.xW(e.options.accept).include(k)})))){return true}else{return false}}function f(){if(glock.ui.DDManager.droppables._lastActive&&(glock.ui.DDManager.droppables._lastActive!=e)){a()}glock.ui.DDManager.droppables._lastActive=e;if(e.options.hoverclass){e.element.addClassName(e.options.hoverclass)}}function a(){if(glock.ui.DDManager.droppables._lastActive&&e.options.hoverclass){glock.ui.DDManager.droppables._lastActive.element.removeClassName(e.options.hoverclass);glock.ui.DDManager.droppables._lastActive=null}}e.dragHandler=function(h,i,j){if(g(h,i,j)){e.inside=true;f();if(glock.isFunction(e.options.onHover)){e.options.onHover(e,j)}}else{if(e.inside&&(!e.movedOut)){e.inside=false;e.movedOut=true}if(e.movedOut){a();e.movedOut=false}}};e.dropHandler=function(h,i,j){if(g(h,i,j)){if(glock.isFunction(e.options.onDrop)){e.options.onDrop(e,j)}a()}};glock.extObj(e.options,arguments[1]||{});glock.ui.DDManager.droppables.push(e);return e};glock.ui.makeSortable=function(d,k){var e={};e.element=glock.x(d);if(!e.element){return false}e.options={tag:"li",only:"",overlap:"vertical",constraint:"vertical",containment:[],handle:"",hoverclass:"",ghosting:false,dropOnEmpty:false,scroll:false,scrollSensitivity:10,scrollSpeed:15,tree:false,treeTag:"ul",onUpdate:false};glock.extObj(e.options,arguments[1]||{});e.lastMovedDraggable=false;var j,i,h=null,g=null;function b(m,n){var l=glock.event.pointerX(n),o=glock.event.pointerY(n);glock.xA(glock.ui.DDManager.draggables).each(function(t){if(t.element==m.element){return}if(glock.ui.position.within(t.element,l,o)){var s=glock.element.cumulativeOffset(t.element),r=s.left+Math.round(t.element.getWidth()/2),q=s.top+Math.round(t.element.getHeight()/2);switch(e.options.constraint){case"vertical":h=o<q;break;case"horizontal":h=l<j;break}var p=h?"before":"after";m.oldPlaceHolder.insertEl(p,t.element);g=null}})}function a(l,m){if(glock.isFunction(e.options.onUpdate)){e.options.onUpdate(e,m)}}var f=e.element.select(e.options.tag);glock.a.each(f,function(l){glock.x(l).addClassName("unselectable");glock.ui.makeDraggable(l,{revert:true,handle:e.options.handle,absolutize:true,onEnd:a,onDrag:b})});glock.ui.makeDroppable(e.element,{onDrop:function(l){}});glock.ui.DDManager.sortables.push(e);return e};glock.element.isParent=function(b,a){if(!b.parentNode||b==a){return false}if(b.parentNode==a){return true}return glock.element.isParent(b.parentNode,a)};glock.element.findChildren=function(e,b,a,d){if(!glock.x(e).hasChildNodes()){return false}if(d){d=d.toUpperCase()}if(b){b=glock.xA([b]).flatten()}var f=glock.xA([]);glock.xA(e.childNodes).each(function(h){if(h.tagName&&h.tagName.toUpperCase()==d&&(!b||(glock.element.classNames(h).detect(function(i){return b.include(i)})))){f.push(h)}if(a){var g=glock.element.findChildren(h,b,a,d);if(g){f.push(g)}}});return(f.length>0?f.flatten():[])};glock.element.offsetSize=function(a,b){return a["offset"+((b=="vertical"||b=="height")?"Height":"Width")]};glock.string.parseColor=function(){var a="#";if(this.slice(0,4)=="rgb("){var d=this.slice(4,this.length-1).split(",");var b=0;do{a+=parseInt(d[b]).toColorPart()}while(++b<3)}else{if(this.slice(0,1)=="#"){if(this.length==4){for(var b=1;b<4;b++){a+=(this.charAt(b)+this.charAt(b)).toLowerCase()}}if(this.length==7){a=this.toLowerCase()}}}return(a.length==7?a:(arguments[0]||this))};glock.element.collectTextNodes=function(a){return glock.xA(glock.x(a).childNodes).collect(function(b){return(b.nodeType==glock.nodeType.TEXT?b.nodeValue:(b.hasChildNodes()?glock.element.collectTextNodes(b):""))}).flatten().join("")};glock.element.collectTextNodesIgnoreClass=function(a,b){return glock.xA(glock.x(a).childNodes).collect(function(d){return(d.nodeType==glock.nodeType.TEXT?d.nodeValue:((d.hasChildNodes()&&!glock.element.hasClassName(d,b))?glock.element.collectTextNodesIgnoreClass(d,b):""))}).flatten().join("")};glock.element.setContentZoom=function(a,b){a=glock.x(a);a.setStyle({fontSize:(b/100)+"em"});if(glock.env.webkit){window.scrollBy(0,0)}return a};glock.element.getInlineOpacity=function(a){return glock.x(a).style.opacity||""};glock.element.forceRerendering=function(a){try{a=glock.x(a);var d=document.createTextNode(" ");a.appendChild(d);a.removeChild(d)}catch(b){}};glock.effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:glock.idfu,sinoidal:function(a){return(-Math.cos(a*Math.PI)/2)+0.5},reverse:function(a){return 1-a},flicker:function(a){var a=((-Math.cos(a*Math.PI)/4)+0.75)+Math.random()/4;return a>1?1:a},wobble:function(a){return(-Math.cos(a*Math.PI*(9*a))/2)+0.5},pulse:function(b,a){return(-Math.cos((b*((a||5)-0.5)*2)*Math.PI)/2)+0.5},spring:function(a){return 1-(Math.cos(a*4.5*Math.PI)*Math.exp(-a*6))},none:function(a){return 0},full:function(a){return 1}},DefaultOptions:{duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:"parallel"},tagifyText:function(a){var b="position:relative";if(glock.env.ie){b+=";zoom:1"}a=glock.x(a);glock.xA(a.childNodes).each(function(d){if(d.nodeType==3){glock.xA(d.nodeValue.toArray()).each(function(e){a.insertBefore(glock.builder.node("span",{style:b}).update(e==" "?glock.string.fromCharCode(160):e),d)});glock.element.remove(d)}})},multiple:function(b,d){var f;if(((typeof b=="object")||glock.isFunction(b))&&(b.length)){f=b}else{f=glock.x(b).childNodes}var a=glock.extObj({speed:0.1,delay:0},arguments[2]||{});var e=a.delay;glock.xA(f).each(function(h,g){new d(h,glock.extObj(a,{delay:g*a.speed+e}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(b,d){b=glock.x(b);d=(d||"appear").toLowerCase();var a=glock.extObj({queue:{position:"end",scope:(b.id||"global"),limit:1}},arguments[2]||{});glock.effect[b.visible()?glock.effect.PAIRS[d][1]:glock.effect.PAIRS[d][0]](b,a)}};glock.effect.DefaultOptions.transition=glock.effect.Transitions.sinoidal;glock.effect.ScopedQueue=function(){var a=glock.object(glock.enumerable);glock.extObj(a,{_each:function(b){this.effects._each(b)},add:function(d){var e=new Date().getTime();var b=glock.isString(d.options.queue)?d.options.queue:d.options.queue.position;switch(b){case"front":glock.a.each(this.effects.findAll(function(f){return f.state=="idle"}),function(f){f.startOn+=d.finishOn;f.finishOn+=d.finishOn});break;case"with-last":e=glock.xA(this.effects).pluck("startOn").max()||e;break;case"end":e=glock.xA(this.effects).pluck("finishOn").max()||e;break}d.startOn+=e;d.finishOn+=e;if(!d.options.queue.limit||(this.effects.length<d.options.queue.limit)){this.effects.push(d)}if(!this.interval){this.interval=setInterval(glock.xF(this.loop).bind(this),15)}},remove:function(b){this.effects=glock.xA(this.effects).reject(function(d){return d==b});if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){var e=new Date().getTime();for(var d=0,b=this.effects.length;d<b;d++){this.effects[d]&&this.effects[d].loop(e)}}});a.effects=[];a.interval=null;return a};glock.effect.Queues={instances:glock.hash({}),get:function(a){if(!glock.isString(a)){return a}return this.instances.get(a)||this.instances.set(a,new glock.effect.ScopedQueue())}};glock.effect.Queue=glock.effect.Queues.get("global");glock.effect.Base={position:null,start:function(a){function b(e,d){return((e[d+"Internal"]?"this.options."+d+"Internal(this);":"")+(e[d]?"this.options."+d+"(this);":""))}if(a&&a.transition===false){a.transition=glock.effect.Transitions.linear}this.options=glock.extObj(glock.extObj({},glock.effect.DefaultOptions),a||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;this.render=(function(){function d(f,e){if(f.options[e+"Internal"]){f.options[e+"Internal"](f)}if(f.options[e]){f.options[e](f)}}return function(e){if(this.state==="idle"){this.state="running";d(this,"beforeSetup");if(this.setup){this.setup()}d(this,"afterSetup")}if(this.state==="running"){e=(this.options.transition(e)*this.fromToDelta)+this.options.from;this.position=e;d(this,"beforeUpdate");if(this.update){this.update(e)}d(this,"afterUpdate")}}})();this.event("beforeStart");if(!this.options.sync){glock.effect.Queues.get(glock.isString(this.options.queue)?"global":this.options.queue.scope).add(this)}},loop:function(d){if(d>=this.startOn){if(d>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");if(this.finish){this.finish()}this.event("afterFinish");return}if(this){var b=(d-this.startOn)/this.totalTime,a=Math.round(b*this.totalFrames);if(a>this.currentFrame){this.render(b);this.currentFrame=a}}}},cancel:function(){if(!this.options.sync){glock.effect.Queues.get(glock.isString(this.options.queue)?"global":this.options.queue.scope).remove(this)}this.state="finished"},event:function(a){if(this.options[a+"Internal"]){this.options[a+"Internal"](this)}if(this.options[a]){this.options[a](this)}},inspect:function(){var a=glock.xH({});for(property in this){if(!glock.isFunction(this[property])){a.set(property,this[property])}}return"#<Effect:"+a.inspect()+",options:"+glock.hash(this.options).inspect()+">"}};glock.effect.parallel=function(b){var a=glock.object(glock.effect.Base);glock.extObj(a,{initialize:function(d){},update:function(d){this.effects.invoke("render",d)},finish:function(d){glock.a.each(this.effects,function(e){e.render(1);e.cancel();e.event("beforeFinish");if(e.finish){e.finish(d)}e.event("afterFinish")})}});a.effects=b||[];a.start(arguments[1])};glock.effect.tween=function(d,h,g){var e={};glock.extObj(e,glock.effect.Base,{update:function(i){this.method(i)}});d=glock.isString(d)?glock.x(d):d;var b=glock.xA(arguments),f=b.last(),a=b.length==5?b[3]:null;e.method=glock.isFunction(f)?glock.xF(f).bind(d):glock.isFunction(d[f])?glock.xF(d[f]).bind(d):function(i){d[f]=i};e.start(glock.extObj({from:h,to:g},a||{}));return e};glock.effect.event=function(a){var b=glock.object(glock.effect.Base);glock.extObj(b,{update:glock.emptyFunction});b.start(glock.extObj({duration:0},arguments[0]||{}));return b};glock.effect.opacity=function(b){var d=glock.object(glock.effect.Base);glock.extObj(d,{update:function(e){this.element.setOpacity(e)}});d.element=glock.x(b);if(!d.element){throw (glock.effect._elementDoesNotExistError)}if(glock.env.ie&&(!d.element.currentStyle.hasLayout)){d.element.setStyle({zoom:1})}var a=glock.extObj({from:d.element.getOpacity()||0,to:1},arguments[1]||{});d.start(a);return d};glock.effect.move=function(b){var d=glock.object(glock.effect.Base);glock.extObj(d,{setup:function(){glock.element.makePositioned(this.element);this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");if(this.options.mode=="absolute"){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop}},update:function(e){glock.x(this.element).setStyle({left:Math.round(this.options.x*e+this.originalLeft)+"px",top:Math.round(this.options.y*e+this.originalTop)+"px"})}});d.element=glock.x(b);if(!d.element){throw (glock.effect._elementDoesNotExistError)}var a=glock.extObj({x:0,y:0,mode:"relative"},arguments[1]||{});d.start(a);return d};glock.ui.makeButton=function(a){var g={};a=a||{};var q=a.caption||false,r=a.icon||false,n=a.iconDisabled||false,i=a.rightIcon||false,m=false,l=a.width||false,p=a.dropdown||false,u=a.onclick||function(){},s,o,k=a.size||false,j,f=false;var t=glock.xF(glock.builder.node).bind(glock.builder);function e(){glock.element.addClassName(g.DOMNode,"disabled");if(n){j.src=n}f=true}function h(){glock.element.removeClassName(g.DOMNode,"disabled");if(r){j.src=r}f=false}g.DOMNode=t("div",{className:"gl-button"},[o=t("div",{className:"gl-button-caption"})]);if(l){g.DOMNode.style.width=l+"px"}if(q){if(r){j=t("img",{className:"gl-button-icon",src:r})}var d=t("span",{style:"float:left;"},q);if(i){o.appendChild(d);if(r){o.appendChild(j);glock.element.addClassName(j,"right")}}else{if(r){o.appendChild(j)}o.appendChild(d)}if(p){o.appendChild(t("div",{className:"gl-button-ddarrow"}))}}glock.ui.disableSelection(g.DOMNode);if(k){glock.x(g.DOMNode).addClassName(k)}glock.event.observe(g.DOMNode,"mousedown",function(){if(f){return}m=true;glock.x(g.DOMNode).addClassName("down")});glock.event.observe(document,"mouseup",function(w){if(f){return}var b;m=false;glock.x(g.DOMNode).removeClassName("down");var v=glock.event.element(w);b=glock.x(v).up(".gl-button");if(g.DOMNode==v||b==g.DOMNode){u.call(g,w)}});g.hide=function(){glock.element.hide(g.DOMNode)};g.show=function(){glock.element.show(g.DOMNode)};g.disable=e;g.enable=h;return g};glock.ui.popup=function(g){g=g||{};var h={};var f=g.items||[],e=g.onHide||glock.emptyFucntion;var d=glock.xF(glock.builder.node).bind(glock.builder);var i,j;i=document.createElement("ul");i.className="gl-popup-menu wicons";function a(b){if(b){return d("img",{src:b})}return false}glock.a.each(f,function(k){var b;if(k.caption=="-"){b=d("li",[d("div",{className:"gl-popup-separator"})])}else{b=d("li",[d("div",{className:"gl-popup-item"},[a(k.icon),d("span",k.caption)])]);glock.event.observe(b,"mouseover",function(){glock.element.addClassName(b,"active")});glock.event.observe(b,"mouseout",function(){glock.element.removeClassName(b,"active")})}if(k.onClick){glock.event.observe(b,"click",function(){k.onClick();if(glock.element.visible(h.DOMNode)){glock.element.hide(h.DOMNode);if(e){e()}}})}i.appendChild(b)});h.DOMNode=d("div",{style:"display: none;",className:"gl-popup-wrapper"},[i,j]);document.body.appendChild(h.DOMNode);glock.event.observe(document.body,"mouseup",function(b){if(!glock.element.visible(h.DOMNode)){return}c=glock.ui.position.cursor(b);if(!glock.ui.position.withinIncludingScrolloffsets(h.DOMNode,c.x,c.y)){glock.element.hide(h.DOMNode);if(e){e()}}});h.popup=function(b){var k=glock.ui.position.cursor(b);if(k){h.DOMNode.style.left=k.x+"px";h.DOMNode.style.top=k.y+"px";glock.element.show(h.DOMNode)}};h.popupFromEl=function(b){if(!b){return}var l=glock.element.viewportOffset(b),m=window.scrollX||document.body.scrollLeft,k=window.scrollY||document.body.scrollTop;if(l){h.DOMNode.style.left=(l.left+m)+"px";h.DOMNode.style.top=(l.top+glock.element.getHeight(b)+1+k)+"px";glock.element.show(h.DOMNode)}};return h};glock.ui.makeEditCombo=function(a){a=a||{};var g=a.list||[],q=a.controller||false,s=a.editName||false,p=a.editId||false,t=a.width||false,w=a.onChange||glock.emptyFunction;var h={},z=glock.xF(glock.builder.node).bind(glock.builder),n,A,r,l,e=[],x,m,f,v,k=true;w=glock.xF(w).bind(h);function j(I){I=I||{};var J=I.items||[],E=I.left||0,M=I.top||0,B=I.width||false,O=I.height||false,b=I.strictWidth||false,K,L;var D,C="min-width:auto;",G="height:auto;";if(B){if(b){C="width:"+B+"px;"}else{C="min-width:"+B+"px;"}}if(O){G="height:"+O+"px;"}K=glock.x(n).cumulativeScrollOffset();L=glock.x(n).cumulativeOffset();E=K.left+L.left;M=K.top+L.top+glock.x(n).getHeight()+1;l=z("ul",{style:"z-index: 1005; display:none; "+C+" "+G+" left:"+E+"px; top: "+M+"px;",className:"gl-cbox-ddlist"});for(var F=0;F<J.length;F++){var N;var H=new Date();var P="ddli"+H.getTime();N=z("div",{id:P,className:"gl-cbox-ddlist-item"},[z("span",J[F].caption)]);if(typeof J[F].onclick!=="undefined"){glock.event.observe(N,"click",glock.xF(J[F].onclick).bindAsEventListener(J[F]))}glock.event.observe(N,"click",glock.xF(function(){glock.x(this).hide()}).bindAsEventListener(l));l.appendChild(z("li",[N]))}document.body.appendChild(l);glock.x(l).show()}function u(d,b){d=glock.x(d);b=glock.x(b);if((!d)||(!b)){return false}var i=d.parentNode;while(i){if(b.id==i.id){return true}if(i.nodeName.toLowerCase()=="body"){return false}i=i.parentNode}return false}function o(d){var b=this;if(b){r.value=b.caption}}var y=new Date();var m="gl-cbox-"+y.getTime();A=z("div",{className:"gl-ecbox-button"});f={type:"text",className:"gl-ecbox-edit"};if(s){f.name=s}if(p){f.id=p}if(t){f.style="width:"+(t-18)+"px;"}r=z("input",f);v={id:m,className:"gl-ecbox"};if(t){v.style="wisth:"+t+"px;"}n=z("div",v,[r,A]);glock.event.observe(A,"click",function(){if(!k){return}if(l){if(glock.x(l).visible()){glock.x(l).hide();return}else{glock.x(l).remove();e=[]}}for(x=0;x<g.length;x++){e[e.length]={caption:g[x],onclick:o}}if(n){var b=glock.element.positionedOffset(n);b.top+=glock.element.getHeight(n)+1}j({width:glock.x(n).getWidth(),strictWidth:true,items:e,left:b.left,top:b.top})});glock.event.observe(r,"change",function(){h.addItem(r.value)});glock.event.observe(window,"click",function(i){i=i||window.event;var b,d=glock.event.element(i);if(!u(d,m)){if(l){glock.x(l).hide()}}});if(q){q.addControl(m)}h.DOMNode=n;h.edit=r;h.addItem=function(b){if(!h.hasItem(b)){g[g.length]=b;w()}};h.hasItem=function(d){var b;for(b=0;b<g.length;b++){if(g[b]===d){return true}}return false};h.fromString=function(b){h.fromObject(b.evalJSON(true))};h.fromObject=function(b){if(typeof b=="object"){if(l){glock.x(l).remove()}l=false;g=glock.xA(b.items).clone();r.value=b.selected}};h.disable=function(){r.disabled=true;k=false};h.enable=function(){r.disabled=false;k=true};h.toObject=function(){return{items:g,selected:r.value}};h.serialize=function(){return glock.json.stringify(h.toObject())};return h};glock.ui.makeCalendar=function(f){var I={lang:{weekDaysS:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekDaysSS:["S","M","T","W","T","F","S"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsS:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}};var r={},f=f||{},s=f.place||false,K=f.name||false,D=f.showTime||false,H=glock.xF(glock.builder.node).bind(glock.builder),J=f.lang||I.lang,G=f.startWeekFromMonday||false,i=f.hideHeader||false,j=f.hideWeekNum||false,z=f.hidePrevScroller||false,A=f.hideNextScroller||false,l=f.onPrevMonthClick||false,n=f.onNextMonthClick||false,m=f.shadedInactive||false,h=f.selectFrom||false,y=f.selectTo||false,F=glock.date.parseMySQLDateTime(f.date)||new Date(),d=document.createDocumentFragment(),v,e,u=false,p=false,B=f.onChange||function(){};B=glock.xF(B).bind(r);r.onChange=B;function o(L){var b=document.createElement("th");if(L){b.innerHTML=L}return b}function q(L,M){var b=document.createElement("td");if(L){b.className=L}if(M){b.innerHTML=M}return b}function a(b){var L=document.createElement("tr");if(b){L.className=b}return L}function C(L,M){var b=document.createElement("span");if(L){b.className=L}if(M){b.innerHTML=M}return b}function w(L,M){var b=document.createElement("div");if(L){b.className=L}if(M){b.innerHTML=M}return b}function k(){if(u){u.value=r.getMYSQLDate()}r.onChange()}function g(T){var M=[],O,N=[],L=new Date(T.getTime())||new Date(),R=new Date(L.getTime()),b=true,Q;L.setDate(1);var S=L.getDay(),P=L.getMonth();if(G){S=S-1;if(S<0){S=6}}L=glock.date.sub(L,S,"d");do{N=[];for(O=1;O<8;O++){Q={d:L.getDate(),m:L.getMonth(),y:L.getFullYear()};if(glock.date.dateEqual(F,L)){Q.today=true}if(glock.date.dateEqual(R,L)){Q.active=true}N[N.length]=Q;L=glock.date.add(L,1,"d")}M[M.length]=N;if(L.getMonth()!=P){b=false}}while(b);return M}function x(S){var U,T,Z,O,L,ac,ab,b,X,V,aa,Y=S||new Date(),Q=r.now.getMonth();V=g(Y);O=H("table",{className:"gl-cal-tbl"},[H("thead",[ab=H("tr")]),L=H("tbody")]);U=0;Z=6;if(G){U=1;Z=6}if(!j){ab.appendChild(o())}for(U;U<=Z;U++){ab.appendChild(o(J.weekDaysS[U]))}if(G){ab.appendChild(o(J.weekDaysS[0]))}var ad,N,W,R,P,M;for(U=0,R=V.length;U<R;U++){b=a();ad=V[U][2];N=glock.date.getWeekOfYear(new Date(ad.y,ad.m,ad.d),G?1:0);if(!j){P=q("gl-cal-weekNum","<span>"+N+"</span>");b.appendChild(P)}for(T=0;T<7;T++){aa=V[U][T];M="";if(aa.m!=Q){M+=" shaded"}if(h&&y&&glock.date.beetweenAndInclude(new Date(aa.y,aa.m,aa.d),h,y)){M+=" selected"}if(glock.date.dateEqual(new Date(aa.y,aa.m,aa.d),new Date())){M+=" today"}M+=aa.active?" active":"";b.appendChild(H("td",[X=w("gl-cal-tbl-cell"+M,"<span>"+aa.d+"</span>")]));if((aa.m!=Q)&&m){}else{glock.event.observe(X,"click",glock.xF(function(){var ag=this.d,ae=this.cell;r.now=new Date(ag.y,ag.m,ag.d);if(D){var af=glock.date.parseTime(p.value);if(af){r.now.setHours(af.h);r.now.setMinutes(af.m);r.now.setSeconds(af.s)}}glock.a.each(glock.x(r.DOMNode).select("div.active"),function(ah){glock.element.removeClassName(ah,"active")});k();glock.element.addClassName(ae,"active")}).bindAsEventListener({d:aa,cell:X}))}}L.appendChild(b)}return O}function E(){return glock.date.getFormated(r.now,"h:mm tt")}function t(U){glock.removeChildNodes(v);var O=U||r.now;var R,M,N,Q,b,P,T;if(z){M=false}else{M=C("gl-cal-sbtn left","<span></span>");if(l){l=glock.xF(l).bind(r)}else{l=function(){r.now=glock.date.sub(r.now,1,"mon");t(r.now)}}glock.event.observe(M,"click",l)}if(A){N=false}else{N=C("gl-cal-sbtn right","<span></sapn>");if(n){n=glock.xF(n).bind(r)}else{n=function(){r.now=glock.date.add(r.now,1,"mon");t(r.now)}}glock.event.observe(N,"click",n)}function L(W){var V=0,X=H("select",{style:"display: none;"});glock.a.each(J.months,function(Y){X.appendChild(H("option",{value:V},Y));V++});X.selectedIndex=W;return X}function S(Z){var X,W,V=0,Y=H("select",{style:"display: none;"});for(X=Z-3,W=0;X<=Z+3;X++,W++){Y.appendChild(H("option",{value:X},X));if(X==Z){V=W}}Y.selectedIndex=V;return Y}if(!i){R=H("div",{className:"gl-cal-controls"},[M,N,H("div",{className:"gl-cal-head"},[Q=H("span",J.months[O.getMonth()]),P=L(O.getMonth()),", ",b=H("span",O.getFullYear()),T=S(O.getFullYear())])]);glock.event.observe(Q,"click",function(V){glock.element.show(P);glock.element.hide(Q);glock.event.stop(V)});glock.event.observe(P,"change",function(V){r.now.setMonth(P.value);t(r.now);glock.element.hide(P);Q.innerHTML=J.months[P.value];glock.element.show(Q);k();glock.event.stop(V)});glock.event.observe(b,"click",function(V){glock.element.show(T);glock.element.hide(b);glock.event.stop(V)});glock.event.observe(T,"change",function(V){r.now.setYear(T.value);t(r.now);glock.element.hide(T);b.innerHTML=T.value;glock.element.show(b);k();glock.event.stop(V)});v.appendChild(R)}v.appendChild(x(O));if(D){v.appendChild(H("div",{className:"gl-cal-footer"},[H("span","Time: "),p=H("input",{type:"text",className:"gl-cal-timeedit",value:E()})]));glock.event.observe(p,"change",function(){var V=glock.date.parseTime(p.value);if(V){r.now.setHours(V.h);r.now.setMinutes(V.m);r.now.setSeconds(V.s)}k()})}if(K){v.appendChild(u=H("input",{type:"hidden",name:K,value:r.getMYSQLDate()}));u.glockEl=r}}r.getMYSQLDate=function(){return D?glock.date.getMySQLDateTime(r.now):glock.date.getMySQLDate(r.now)};r.setDate=function(b){r.now=new Date(b.valueOf());t(r.now)};r.add=function(b,L){r.now=glock.date.add(r.now,b,L);t(r.now)};r.sub=function(b,L){r.now=glock.date.sub(r.now,b,L);t(r.now)};r.selectRange=function(L,b){h=L;y=b;t(r.now)};r.clearSelection=function(){h=false;y=false;t(r.now)};r.now=new Date(F.getTime());var H=glock.xF(glock.builder.node).bind(glock.builder);v=w("gl-cal");t();v.glockEl=r;if(s){s=glock.x(s);e=s.readAttribute("name");if(!K){K=e}glock.element.replace(s,v)}r.DOMNode=v;return r};glock.ui.makeDDCalendar=function(m){var j={},m=m||{},o=glock.xF(glock.builder.node).bind(glock.builder),g=m.place||false,a=m.name||false,p=m.format||"MMMM dd, yyyy",r="",h=m.cal||{},e=m.width||false,l=m.onChange||glock.emptyFunction,r,d,f,k=true;j.ddcWrap=o("div",{className:"gl-cbox-wrp"},[j.cbox=o("div",{className:"gl-cbox"},[f=o("div",{className:"gl-cbox-row-itms"},""),btn=o("div",{className:"gl-ddbox-cal-btn"})])]);if(e){j.cbox.style.width=(e+4)+"px"}j.onChange=l;h._onChange=h.onChange;h.onChange=function(){j.now=new Date(this.now.getTime());f.innerHTML=glock.date.getFormated(this.now,p);if(j.input){j.input.value=j.cal.getMYSQLDate()}};function q(){j.onChange()}j.DOMNode=j.ddcWrap;if(g){g=glock.x(g);r=g.readAttribute("name");if(!a){a=r}glock.element.replace(g,j.ddcWrap)}if(a){j.input=o("input",{type:"hidden",name:a});j.ddcWrap.appendChild(j.input);j.input.glockEl=j}var n,i;j.cal=glock.ui.makeCalendar(h);j.now=new Date(j.cal.now.getTime());f.innerHTML=glock.date.getFormated(j.now,p);document.body.appendChild(j.cal.DOMNode);j.originalCal=j.cal.DOMNode;j.cal.DOMNode.style.display="none";j.cal.DOMNode.style.position="absolute";j.cal.DOMNode.style.zIndex=1005;n=glock.x(j.ddcWrap).cumulativeOffset();i=glock.x(j.ddcWrap).getDimensions();j.cal.DOMNode.style.left=(n[0])+"px";j.cal.DOMNode.style.top=(n[1]+i.height+1)+"px";j.input.value=j.cal.getMYSQLDate();glock.event.observe(btn,"click",glock.xF(function(){if(!k){return}var w=glock.x(this.cal.DOMNode);var v=glock.element.cumulativeOffset(j.ddcWrap);var u=glock.element.cumulativeScrollOffset(j.ddcWrap);var t=glock.element.getDimensions(j.ddcWrap);var s=v[0];var b=v[1]+t.height+1;w.style.left=s+"px";w.style.top=b+"px";if(w.visible()){w.hide();q()}else{w.show()}}).bindAsEventListener(j));glock.event.observe(document,"click",glock.xF(function(s){if(!this.cal){return}var b=glock.event.pointer(s).x,u=glock.event.pointer(s).y,t=this.cal.DOMNode;glock.ui.position.prepare();if(this.cbox&&t&&!glock.ui.position.withinIncludingScrolloffsets(this.cbox,b,u)&&!glock.ui.position.withinIncludingScrolloffsets(t,b,u)){if(t){t=glock.x(t);if(t.visible()){t.hide();q()}}}}).bindAsEventListener(j));j.disable=function(){k=false};j.enable=function(){k=true};j.setDate=function(b){var b=b||new Date();if(j&&j.cal){j.cal.now=new Date(b.getTime())}j.now=new Date(b.getTime());f.innerHTML=glock.date.getFormated(b,p);if(j.input){j.input.value=j.cal.getMYSQLDate()}q()};j.getMYSQLDate=function(){return j.cal.getMYSQLDate()};j.setMYSQLDate=function(b){j.setDate(glock.date.parseMySQLDateTime(b))};j.destroy=function(){glock.element.remove(j.originalCal)};return j};glock.ui.makeCbDropdownList=function(d){var h={},d=d||{},q=glock.xF(glock.builder.node).bind(glock.builder),m=d.width||false,j=d.place||false,t=d.name||false,i,e,l,p,a,k=false,n=d.onChange||function(){};n=glock.xF(n).bind(h);h.onChange=n;h.items=d.items||[];function f(){if(k){k.value=h.getCSValues()}h.onChange()}function r(){var v="Select options",u="",b,w=true;glock.xA(h.items).each(function(x){if(x.checked){if(w){w=false;v=""}else{u=", "}v+=u+x.text}});l.innerHTML=v}function s(b){glock.xA(glock.x(p).select("input")).each(function(u){u.checked=b});glock.xA(h.items).each(function(u){u.checked=b})}function o(v){var u=this,b,w;if(u){b=glock.x(u).down("input");if(b){if(!v.glcbClicked){b.checked=!b.checked}if(b.glcbElement){b.glcbElement.checked=b.checked}else{s(b.checked)}if(!v.glcbClicked){f()}}}r()}function g(y){if(p){p=glock.x(p);if(p.visible()){p.hide()}else{p.show()}return}var A,x,b,B,w,u,v,z,C,D;p=q("ul",{style:"display: none;",className:"gl-cbox-ddlist"});p.style.minWidth=(m+6)+"px";p.appendChild(D=q("li",{className:"gl-cbox-ddlist-li gl-cbox-selectall"},[v=q("input",{type:"checkbox"}),z=q("span","Select All")]));glock.event.observe(v,"click",function(E){E.glcbClicked=true});glock.event.observe(v,"change",function(){s(v.checked);r();f()});glock.event.observe(D,"click",glock.xF(o).bindAsEventListener(D));for(w=0;w<h.items.length;w++){C={type:"checkbox"};p.appendChild(D=q("li",{className:"gl-cbox-ddlist-li"},[u=q("input",C),z=q("span",h.items[w].text)]));u.glcbElement=h.items[w];glock.event.observe(D,"click",glock.xF(o).bindAsEventListener(D));if(h.items[w].checked){u.checked=true}glock.event.observe(u,"click",function(E){E.glcbClicked=true});glock.event.observe(u,"change",glock.xF(function(E){this.el.checked=this.cb.checked;r();f();glock.event.stop(E)}).bindAsEventListener({cb:u,el:h.items[w]}))}A=glock.x(e).cumulativeOffset();x=glock.x(e).getDimensions();p.style.left=A.left+"px";p.style.top=(A.top+x.height-1)+"px";h.DOMNode.appendChild(p);glock.x(p).show()}h.serialize=function(){glock.xA(h.items).each(function(b){if(!b.checked){b.checked=false}});return glock.json.stringify(h.items)};h.getCSValues=function(){var u="",v,w=true,b=0;glock.xA(h.items).each(function(x){if(x.checked){if(w){w=false;v=""}else{v=", "}u+=v+x.value;b++}});if(b==h.items.length){u=""}return u};h.DOMNode=q("div",{className:"gl-cbox-wrp"},[e=q("div",{className:"gl-cbox"},[l=q("div",{className:"gl-cbox-row-itms"},""),i=q("div",{className:"gl-cbox-btn"})])]);h.DOMNode.glockEl=h;if(j){j=glock.x(j);a=j.readAttribute("name");if(!t){t=a}glock.element.replace(j,h.DOMNode)}if(t){h.DOMNode.appendChild(k=q("input",{type:"hidden",name:t,value:h.getCSValues()}));k.glockEl=h}glock.event.observe(i,"click",function(b){g(b);glock.event.stop(b)});glock.event.observe(e,"click",function(b){g(b);glock.event.stop(b)});glock.event.observe(document,"click",function(u){var b=glock.event.pointer(u).x,v=glock.event.pointer(u).y;glock.ui.position.prepare();if(e&&p&&!glock.ui.position.withinIncludingScrolloffsets(e,b,v)&&!glock.ui.position.withinIncludingScrolloffsets(p,b,v)){if(p){p=glock.x(p);if(p.visible()){p.hide()}}}});r();if(m){e.style.width=m+"px"}return h};